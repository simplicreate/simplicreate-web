{"version":3,"sources":["../../src/ux/colorizeJson.ts"],"sourcesContent":["import {styleText} from 'node:util'\n\nimport tokenize, {type LexerToken} from 'json-lexer'\n\ninterface KeyToken {\n  raw: string\n  type: 'key'\n  value: string\n}\n\ntype ExtendedLexerToken = KeyToken | LexerToken\n\n/**\n * Colorize JSON output for better readability using simple regex patterns\n */\nconst identity = (inp: string): string => inp\n\nexport function colorizeJson(input: unknown): string {\n  const formatters: Record<ExtendedLexerToken['type'], (str: string) => string> = {\n    key: (s) => styleText('white', s),\n    literal: (s) => styleText('bold', s),\n    number: (s) => styleText('yellow', s),\n    punctuator: (s) => styleText('white', s),\n    string: (s) => styleText('green', s),\n    whitespace: identity,\n  }\n\n  const json = JSON.stringify(input, null, 2)\n\n  return tokenize(json)\n    .map((token, i, arr): ExtendedLexerToken => {\n      // Note how the following only works because we pretty-print the JSON\n      const prevToken = i === 0 ? token : arr[i - 1]\n      if (\n        token.type === 'string' &&\n        prevToken.type === 'whitespace' &&\n        /^\\n\\s+$/.test(prevToken.value)\n      ) {\n        return {...token, type: 'key'}\n      }\n\n      return token\n    })\n    .map((token) => {\n      const formatter = formatters[token.type] || identity\n      return formatter(token.raw)\n    })\n    .join('')\n}\n"],"names":["styleText","tokenize","identity","inp","colorizeJson","input","formatters","key","s","literal","number","punctuator","string","whitespace","json","JSON","stringify","map","token","i","arr","prevToken","type","test","value","formatter","raw","join"],"mappings":"AAAA,SAAQA,SAAS,QAAO,YAAW;AAEnC,OAAOC,cAAiC,aAAY;AAUpD;;CAEC,GACD,MAAMC,WAAW,CAACC,MAAwBA;AAE1C,OAAO,SAASC,aAAaC,KAAc;IACzC,MAAMC,aAA0E;QAC9EC,KAAK,CAACC,IAAMR,UAAU,SAASQ;QAC/BC,SAAS,CAACD,IAAMR,UAAU,QAAQQ;QAClCE,QAAQ,CAACF,IAAMR,UAAU,UAAUQ;QACnCG,YAAY,CAACH,IAAMR,UAAU,SAASQ;QACtCI,QAAQ,CAACJ,IAAMR,UAAU,SAASQ;QAClCK,YAAYX;IACd;IAEA,MAAMY,OAAOC,KAAKC,SAAS,CAACX,OAAO,MAAM;IAEzC,OAAOJ,SAASa,MACbG,GAAG,CAAC,CAACC,OAAOC,GAAGC;QACd,qEAAqE;QACrE,MAAMC,YAAYF,MAAM,IAAID,QAAQE,GAAG,CAACD,IAAI,EAAE;QAC9C,IACED,MAAMI,IAAI,KAAK,YACfD,UAAUC,IAAI,KAAK,gBACnB,UAAUC,IAAI,CAACF,UAAUG,KAAK,GAC9B;YACA,OAAO;gBAAC,GAAGN,KAAK;gBAAEI,MAAM;YAAK;QAC/B;QAEA,OAAOJ;IACT,GACCD,GAAG,CAAC,CAACC;QACJ,MAAMO,YAAYnB,UAAU,CAACY,MAAMI,IAAI,CAAC,IAAIpB;QAC5C,OAAOuB,UAAUP,MAAMQ,GAAG;IAC5B,GACCC,IAAI,CAAC;AACV"}