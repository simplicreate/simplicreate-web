{"version":3,"file":"structure.js","sources":["../src/structure/components/incomingReferencesDecoration/CrossDatasetIncomingReference/CrossDatasetIncomingReferenceType.tsx","../src/structure/components/incomingReferencesDecoration/CreateNewIncomingReference.tsx","../src/structure/components/incomingReferencesDecoration/LinkToExistingPreview.tsx","../src/structure/components/incomingReferencesDecoration/AddIncomingReference.tsx","../src/structure/components/incomingReferencesDecoration/IncomingReferencesType.tsx","../src/structure/components/incomingReferencesDecoration/types.ts","../src/structure/components/incomingReferencesDecoration/IncomingReferencesList.tsx","../src/structure/components/incomingReferencesDecoration/IncomingReferencesDecoration.tsx","../src/structure/components/incomingReferencesDecoration/defineIncomingReferenceDecoration.tsx","../src/structure/components/incomingReferencesDecoration/isIncomingReferenceCreation.ts"],"sourcesContent":["import {Box, Card, Flex, Stack, Text} from '@sanity/ui'\nimport {useCallback, useMemo} from 'react'\nimport {useObservable} from 'react-rx'\nimport {\n  CommandList,\n  type CommandListRenderItemCallback,\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  LoadingBlock,\n  useClient,\n  useDocumentPreviewStore,\n  useSchema,\n  useTranslation,\n} from 'sanity'\n\nimport {structureLocaleNamespace} from '../../../i18n'\nimport {INITIAL_STATE} from '../getIncomingReferences'\nimport {INCOMING_REFERENCES_ITEM_HEIGHT, IncomingReferencesListContainer} from '../shared'\nimport {type CrossDatasetIncomingReference} from '../types'\nimport {CrossDatasetIncomingReferenceDocumentPreview} from './CrossDatasetIncomingReferenceDocumentPreview'\nimport {\n  type CrossDatasetIncomingReferenceDocument,\n  getCrossDatasetIncomingReferences,\n} from './getCrossDatasetIncomingReferences'\n\nexport function CrossDatasetIncomingReferenceType({\n  type,\n  referenced,\n  shouldRenderTitle,\n}: {\n  shouldRenderTitle: boolean\n  referenced: {id: string; type: string}\n  type: CrossDatasetIncomingReference\n}) {\n  const client = useClient(DEFAULT_STUDIO_CLIENT_OPTIONS)\n  const documentPreviewStore = useDocumentPreviewStore()\n\n  const references$ = useMemo(\n    () =>\n      getCrossDatasetIncomingReferences({\n        documentId: referenced.id,\n        client,\n        type: type,\n        documentPreviewStore,\n      }),\n    [client, type, referenced.id, documentPreviewStore],\n  )\n\n  const {documents, loading} = useObservable(references$, INITIAL_STATE)\n\n  const schema = useSchema()\n  const {t} = useTranslation(structureLocaleNamespace)\n  const schemaType = schema.get(type.type)\n\n  const renderItem = useCallback<\n    CommandListRenderItemCallback<CrossDatasetIncomingReferenceDocument>\n  >(\n    (document) => <CrossDatasetIncomingReferenceDocumentPreview document={document} type={type} />,\n    [type],\n  )\n\n  if (!schemaType) return null\n  if (loading) {\n    return <LoadingBlock showText title={t('incoming-references-input.types-loading')} />\n  }\n  return (\n    <Stack space={2} marginBottom={2}>\n      {shouldRenderTitle && (\n        <Box paddingY={2} paddingX={0}>\n          <Text size={1} weight=\"medium\">\n            {type.title || schemaType?.title}\n          </Text>\n        </Box>\n      )}\n      <Card radius={2} padding={1} border tone=\"default\">\n        {documents && documents.length > 0 ? (\n          <IncomingReferencesListContainer $itemCount={documents.length}>\n            <CommandList\n              activeItemDataAttr=\"data-hovered\"\n              ariaLabel={t('incoming-references-input.list-label', {\n                type: type.title || schemaType?.title,\n              })}\n              canReceiveFocus\n              fixedHeight\n              getItemKey={(index) => documents[index].id}\n              itemHeight={INCOMING_REFERENCES_ITEM_HEIGHT}\n              items={documents}\n              onlyShowSelectionWhenActive\n              overscan={5}\n              renderItem={renderItem}\n              wrapAround={false}\n            />\n          </IncomingReferencesListContainer>\n        ) : (\n          <>\n            <Flex align=\"center\" justify=\"center\" padding={2}>\n              <Text size={1} muted>\n                {t('incoming-references-input.no-items')}\n              </Text>\n            </Flex>\n          </>\n        )}\n      </Card>\n    </Stack>\n  )\n}\n","import {uuid} from '@sanity/uuid'\nimport {useCallback, useMemo} from 'react'\nimport {\n  CreateReferenceButton,\n  type CreateReferenceOption,\n  getPublishedId,\n  isNonNullable,\n  useReferenceInputOptions,\n} from 'sanity'\nimport {useRouter} from 'sanity/router'\n\nimport {usePaneRouter} from '../paneRouter'\nimport {type IncomingReferenceCreationParams} from './isIncomingReferenceCreation'\nimport {type IncomingReferencesOptions} from './types'\n\nexport function CreateNewIncomingReference({\n  type,\n  referenceToId,\n  referenceToType,\n  onCreateNewReference,\n  fieldName,\n  creationAllowed,\n}: {\n  type: string\n  referenceToId: string\n  referenceToType: string\n  onCreateNewReference: (id: string) => void\n  fieldName: string\n  creationAllowed: IncomingReferencesOptions['creationAllowed']\n}) {\n  const {initialValueTemplateItems} = useReferenceInputOptions()\n\n  const {navigate} = useRouter()\n  const {routerPanesState, groupIndex} = usePaneRouter()\n\n  const handleCreate = useCallback(\n    (option: CreateReferenceOption) => {\n      const id = uuid()\n      navigate({\n        panes: [\n          ...routerPanesState.slice(0, groupIndex + 1),\n          [\n            {\n              id: getPublishedId(id),\n              params: {type, template: option.template.id},\n              payload: {\n                reference: {\n                  _type: 'reference',\n                  _ref: referenceToId,\n                  _weak: true,\n                  _strengthenOnPublish: {type: referenceToType},\n                },\n                from: {fieldName, type: referenceToType},\n                // eslint-disable-next-line camelcase\n                __internal_isIncomingReferenceCreation: true,\n              } satisfies IncomingReferenceCreationParams,\n            },\n          ],\n        ],\n      })\n      onCreateNewReference(id)\n    },\n    [\n      type,\n      navigate,\n      routerPanesState,\n      groupIndex,\n      referenceToId,\n      referenceToType,\n      onCreateNewReference,\n      fieldName,\n    ],\n  )\n\n  const createOptions = useMemo(() => {\n    if (!creationAllowed) return []\n    return (initialValueTemplateItems || [])\n\n      .filter((i) => {\n        const typeMatch = type === i.template?.schemaType\n        if (Array.isArray(creationAllowed)) {\n          // Check if the template id is in the creationAllowed array\n          return typeMatch && creationAllowed.includes(i.template.id)\n        }\n        return typeMatch\n      })\n      .map((item): CreateReferenceOption | undefined =>\n        item.template?.schemaType\n          ? {\n              id: item.id,\n              title: item.title || `${item.template.schemaType} from template ${item.template?.id}`,\n              i18n: item.i18n,\n              type: item.template.schemaType,\n              icon: item.icon,\n              template: {\n                id: item.template?.id,\n                params: item.parameters,\n              },\n\n              permission: {granted: item.granted, reason: item.reason},\n            }\n          : undefined,\n      )\n      .filter(isNonNullable)\n  }, [creationAllowed, initialValueTemplateItems, type])\n\n  if (!creationAllowed) {\n    return null\n  }\n  return (\n    <CreateReferenceButton\n      id={`create-new-incoming-reference-${type}`}\n      createOptions={createOptions}\n      onCreate={handleCreate}\n    />\n  )\n}\n","import {type SchemaType} from '@sanity/types'\nimport {type BadgeTone, Text} from '@sanity/ui'\nimport {useMemo} from 'react'\nimport {useObservable} from 'react-rx'\nimport {\n  type DocumentPreviewStore,\n  getPreviewStateObservable,\n  getPreviewValueWithFallback,\n  getReleaseIdFromReleaseDocumentId,\n  getReleaseTone,\n  getVersionFromId,\n  isDraftId,\n  isPublishedId,\n  isVersionId,\n  PreviewCard,\n  ReleaseTitle,\n  SanityDefaultPreview,\n  useActiveReleases,\n  useTranslation,\n  VersionInlineBadge,\n} from 'sanity'\n\nexport interface LinkToExistingPreviewProps {\n  documentPreviewStore: DocumentPreviewStore\n  schemaType: SchemaType\n  value: {_id: string; _type: string}\n  onLinkToDocument: () => void\n}\n\nconst getPerspective = (id: string) => {\n  if (isDraftId(id)) return ['drafts']\n  if (isVersionId(id)) return [getVersionFromId(id) as string]\n  if (isPublishedId(id)) return ['published']\n  return ['raw']\n}\n\nexport function LinkToExistingPreview(props: LinkToExistingPreviewProps) {\n  const {schemaType, value, onLinkToDocument} = props\n  const {data: releases} = useActiveReleases()\n  const {t} = useTranslation()\n\n  const previewStateObservable = useMemo(() => {\n    return getPreviewStateObservable(\n      props.documentPreviewStore,\n      schemaType,\n      value._id,\n      getPerspective(value._id),\n    )\n  }, [props.documentPreviewStore, schemaType, value._id])\n\n  const {snapshot, original, isLoading} = useObservable(previewStateObservable, {\n    snapshot: null,\n    isLoading: true,\n    original: null,\n  })\n\n  const badgeProps = useMemo(():\n    | {kind: 'static'; tone: BadgeTone; text: string}\n    | {kind: 'release'; tone: BadgeTone; releaseTitle: string | undefined; releaseFallback: string}\n    | null => {\n    const id = value._id\n    if (isDraftId(id)) {\n      return {\n        kind: 'static',\n        tone: getReleaseTone('drafts'),\n        text: t('release.chip.draft'),\n      }\n    }\n    if (isPublishedId(id)) {\n      return {\n        kind: 'static',\n        tone: getReleaseTone('published'),\n        text: t('release.chip.published'),\n      }\n    }\n    if (isVersionId(id)) {\n      const releaseId = getVersionFromId(id)\n      const release = releases.find((r) => getReleaseIdFromReleaseDocumentId(r._id) === releaseId)\n      if (release) {\n        return {\n          kind: 'release',\n          tone: getReleaseTone(release),\n          releaseTitle: release.metadata.title,\n          releaseFallback: release._id,\n        }\n      }\n    }\n    return null\n  }, [releases, value._id, t])\n\n  /**\n   * If the document is not found, for example because it will be unpublished.\n   * Then we don't want to render the preview of it. Because it shouldn't be possible\n   * to link to a document that will be unpublished in this same release\n   */\n  if (!snapshot && !isLoading) return null\n  return (\n    <PreviewCard __unstable_focusRing onClick={onLinkToDocument} as=\"button\" radius={2}>\n      <SanityDefaultPreview\n        {...getPreviewValueWithFallback({snapshot, original, fallback: value})}\n        isPlaceholder={isLoading}\n        icon={schemaType.icon}\n        layout=\"default\"\n        status={\n          badgeProps ? (\n            <Text size={0}>\n              {badgeProps.kind === 'release' ? (\n                <ReleaseTitle title={badgeProps.releaseTitle} fallback={badgeProps.releaseFallback}>\n                  {({displayTitle}) => (\n                    <VersionInlineBadge $tone={badgeProps.tone}>{displayTitle}</VersionInlineBadge>\n                  )}\n                </ReleaseTitle>\n              ) : (\n                <VersionInlineBadge $tone={badgeProps.tone}>{badgeProps.text}</VersionInlineBadge>\n              )}\n            </Text>\n          ) : undefined\n        }\n      />\n    </PreviewCard>\n  )\n}\n","import {DEFAULT_MAX_FIELD_DEPTH} from '@sanity/schema/_internal'\nimport {type SanityDocumentLike} from '@sanity/types'\nimport {Box, Grid, Stack, Text, useToast} from '@sanity/ui'\nimport {useCallback, useMemo, useState} from 'react'\nimport {useObservableEvent} from 'react-rx'\nimport {catchError, concat, filter, map, type Observable, of, scan, switchMap, tap} from 'rxjs'\nimport {\n  createSearch,\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  getPublishedId,\n  isDraftId,\n  isNonNullable,\n  isPublishedId,\n  isVersionId,\n  ReferenceAutocomplete,\n  type SanityClient,\n  type SchemaType,\n  type SearchStrategy,\n  useClient,\n  useDocumentPreviewStore,\n  useSchema,\n  useSource,\n  useTranslation,\n} from 'sanity'\n\nimport {structureLocaleNamespace} from '../../i18n'\nimport {CreateNewIncomingReference} from './CreateNewIncomingReference'\nimport {LinkToExistingPreview} from './LinkToExistingPreview'\nimport {type IncomingReferencesOptions} from './types'\n\ninterface ReferenceSearchState {\n  hits: ReferenceSearchHit[]\n  isLoading: boolean\n  searchString?: string\n}\n\ninterface ReferenceOption {\n  value: string\n  hit: ReferenceSearchHit\n}\ninterface ReferenceSearchHit {\n  _id: string\n  _type: string\n}\n\nconst INITIAL_SEARCH_STATE: ReferenceSearchState = {\n  hits: [],\n  isLoading: false,\n}\nconst NO_FILTER = () => true\n\nconst incomingReferenceSearch = (\n  client: SanityClient,\n  schemaType: SchemaType,\n  searchStrategy: SearchStrategy | undefined,\n): ((textTerm: string) => Observable<ReferenceSearchHit[]>) => {\n  const search = createSearch([schemaType], client, {\n    maxDepth: DEFAULT_MAX_FIELD_DEPTH,\n    strategy: searchStrategy,\n    tag: 'search.incoming-reference',\n  })\n  return (textTerm: string) =>\n    search(textTerm, {perspective: 'raw'}).pipe(\n      map(({hits}) => hits.map(({hit}) => hit)),\n      map((docs) => {\n        // We want to collate drafts and published documents into a single entry, but keep the versions as a separate entry\n        const byId: Map<string, SanityDocumentLike> = new Map()\n\n        docs.forEach((doc) => {\n          if (isVersionId(doc._id)) {\n            // We want to preserve version documents as a different entry.\n            byId.set(doc._id, doc)\n            return\n          }\n          const publishedId = getPublishedId(doc._id)\n          const entry = byId.get(publishedId)\n          if (!entry) {\n            byId.set(publishedId, doc)\n            // If the document is a draft and the entry is published, we want to keep the draft.\n          } else if (isDraftId(doc._id) && isPublishedId(entry._id)) {\n            byId.set(publishedId, doc)\n          }\n        })\n        return Array.from(byId.values())\n      }),\n      map((collated) =>\n        collated.map((entry) => ({\n          _id: entry._id,\n          _type: entry._type,\n        })),\n      ),\n      map((docs) => docs.slice(0, 100)),\n    )\n}\n\n/**\n * This component is responsible for two things:\n * 1) Search for the document type to add to the incoming references.\n * 2) Render the CreateNewIncomingReference button. Allowing users to add a new incoming reference.\n */\nexport function AddIncomingReference({\n  type,\n  referenced,\n  onCreateNewReference,\n  onLinkDocument,\n  fieldName,\n  creationAllowed,\n}: {\n  type: string\n  referenced: {id: string; type: string}\n  onCreateNewReference: (id: string) => void\n  onLinkDocument: (documentId: string) => void\n  fieldName: string\n  creationAllowed: IncomingReferencesOptions['creationAllowed']\n}) {\n  const {t} = useTranslation(structureLocaleNamespace)\n  const {push} = useToast()\n  const schema = useSchema()\n  const schemaType = schema.get(type)\n  const client = useClient(DEFAULT_STUDIO_CLIENT_OPTIONS)\n  const source = useSource()\n  const {strategy: searchStrategy} = source.search\n  const documentPreviewStore = useDocumentPreviewStore()\n  const handleSearch = useMemo(\n    () => incomingReferenceSearch(client, schemaType!, searchStrategy),\n    [client, schemaType, searchStrategy],\n  )\n\n  const [searchState, setSearchState] = useState(INITIAL_SEARCH_STATE)\n  const handleQueryChange = useObservableEvent((inputValue$: Observable<string | null>) => {\n    return inputValue$.pipe(\n      filter(isNonNullable),\n      switchMap((searchString) =>\n        concat(\n          of({isLoading: true, hits: []}),\n          handleSearch(searchString).pipe(\n            map((hits) => ({hits, searchString, isLoading: false})),\n            catchError((error) => {\n              push({\n                title: 'Reference search failed',\n                description: error.message,\n                status: 'error',\n                id: `reference-search-fail-${type}`,\n              })\n              console.error(error)\n              return of({hits: [], isLoading: false})\n            }),\n          ),\n        ),\n      ),\n\n      scan(\n        (prevState, nextState: ReferenceSearchState) => ({...prevState, ...nextState}),\n        INITIAL_SEARCH_STATE,\n      ),\n\n      tap(setSearchState),\n    )\n  })\n\n  const options: ReferenceOption[] = useMemo(() => {\n    return searchState.hits.map((hit) => ({\n      value: hit._id,\n      hit: hit,\n    }))\n  }, [searchState.hits])\n\n  const handleAutocompleteOpenButtonClick = useCallback(() => {\n    handleQueryChange('')\n  }, [handleQueryChange])\n\n  const renderOption = useCallback(\n    (option: ReferenceOption) => {\n      return (\n        <LinkToExistingPreview\n          onLinkToDocument={() => onLinkDocument(option.value)}\n          documentPreviewStore={documentPreviewStore}\n          schemaType={schemaType!}\n          value={option.hit}\n        />\n      )\n    },\n    [documentPreviewStore, schemaType, onLinkDocument],\n  )\n\n  return (\n    <Stack space={2} padding={2}>\n      <Box paddingY={2}>\n        <Text size={1} weight=\"medium\">\n          {t('incoming-references-input.reference-from', {type})}\n        </Text>\n      </Box>\n      <Grid gap={creationAllowed ? 2 : 0} style={{gridTemplateColumns: '1fr min-content'}}>\n        <ReferenceAutocomplete\n          id={`${type}-autocomplete`}\n          radius={2}\n          autoFocus\n          options={options}\n          placeholder={t('incoming-references-input.type-to-search')}\n          onQueryChange={handleQueryChange}\n          filterOption={NO_FILTER}\n          path={[]}\n          // @ts-expect-error - Types are not derived correctly\n          renderOption={renderOption}\n          openButton={{onClick: handleAutocompleteOpenButtonClick}}\n          referenceElement={null}\n          loading={searchState.isLoading}\n        />\n        <CreateNewIncomingReference\n          type={type}\n          referenceToId={referenced.id}\n          referenceToType={referenced.type}\n          creationAllowed={creationAllowed}\n          onCreateNewReference={onCreateNewReference}\n          fieldName={fieldName}\n        />\n      </Grid>\n    </Stack>\n  )\n}\n","import {AddIcon} from '@sanity/icons'\nimport {type SanityDocument} from '@sanity/types'\nimport {Box, Card, Flex, Stack, Text, useToast} from '@sanity/ui'\nimport {useCallback, useEffect, useMemo, useState} from 'react'\nimport {useObservable} from 'react-rx'\nimport {\n  CommandList,\n  type CommandListRenderItemCallback,\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  getDraftId,\n  getPublishedId,\n  isPublishedId,\n  LoadingBlock,\n  SanityDefaultPreview,\n  useClient,\n  useDocumentPreviewStore,\n  useSchema,\n  useSource,\n  useTranslation,\n} from 'sanity'\n\nimport {Button} from '../../../ui-components/button/Button'\nimport {structureLocaleNamespace} from '../../i18n'\nimport {useDocumentPane} from '../../panes/document/useDocumentPane'\nimport {AddIncomingReference} from './AddIncomingReference'\nimport {CreateNewIncomingReference} from './CreateNewIncomingReference'\nimport {getIncomingReferences, INITIAL_STATE} from './getIncomingReferences'\nimport {IncomingReferenceDocument} from './IncomingReferenceDocument'\nimport {INCOMING_REFERENCES_ITEM_HEIGHT, IncomingReferencesListContainer} from './shared'\nimport {type IncomingReferencesOptions, type IncomingReferenceType} from './types'\n\nexport function IncomingReferencesType({\n  type,\n  referenced,\n  onLinkDocument,\n  actions,\n  shouldRenderTitle,\n  fieldName,\n  creationAllowed,\n  filter,\n  filterParams,\n}: {\n  shouldRenderTitle: boolean\n  referenced: {id: string; type: string}\n  fieldName: string\n  type: IncomingReferenceType\n  onLinkDocument: IncomingReferencesOptions['onLinkDocument']\n  actions: IncomingReferencesOptions['actions']\n  creationAllowed: IncomingReferencesOptions['creationAllowed']\n  filter: IncomingReferencesOptions['filter']\n  filterParams: IncomingReferencesOptions['filterParams']\n}) {\n  const documentPreviewStore = useDocumentPreviewStore()\n  const {displayed} = useDocumentPane()\n  const {getClient} = useSource()\n  const displayedId = displayed?._id as string\n  const references$ = useMemo(\n    () =>\n      getIncomingReferences({\n        documentId: displayedId,\n        documentPreviewStore,\n        type: type.type,\n        filter,\n        filterParams,\n        getClient,\n      }),\n    [documentPreviewStore, type, filter, filterParams, displayedId, getClient],\n  )\n\n  const {documents, loading} = useObservable(references$, INITIAL_STATE)\n\n  const schema = useSchema()\n  const {t} = useTranslation(structureLocaleNamespace)\n  const schemaType = schema.get(type.type)\n  const client = useClient(DEFAULT_STUDIO_CLIENT_OPTIONS)\n  const [isAdding, setIsAdding] = useState(false)\n  const [newReferenceId, setNewReferenceId] = useState<string | null>(null)\n  const {editState} = useDocumentPane()\n  const toast = useToast()\n  const handleAdd = useCallback(() => {\n    setIsAdding((p) => !p)\n  }, [])\n\n  const publishedExists = Boolean(editState?.published)\n\n  const handleCreateNewReference = useCallback(async (documentId: string) => {\n    setIsAdding(false)\n    setNewReferenceId(documentId)\n  }, [])\n\n  const handleLinkDocument = useCallback(\n    async (documentId: string) => {\n      setIsAdding(false)\n      setNewReferenceId(documentId)\n      const liveEdit = Boolean(schemaType?.liveEdit)\n      const document = await client.fetch('*[_id == $id][0]', {id: documentId})\n\n      const linkedDocument = onLinkDocument?.(document, {\n        _type: 'reference',\n        _ref: getPublishedId(referenced.id),\n        ...(publishedExists ? {} : {_weak: true, _strengthenOnPublish: {type: referenced.type}}),\n      })\n      if (!linkedDocument) {\n        setNewReferenceId(null)\n        toast.push({\n          title: 'Not possible to link to document',\n          description: 'The document you are trying to link cannot be linked to',\n          status: 'error',\n        })\n        return\n      }\n\n      // if the document is published and the schema is not live edit, we want to update the draft id, not the published id\n      // If it's a version, we can update the version document.\n      if (isPublishedId(documentId) && !liveEdit) {\n        linkedDocument._id = getDraftId(documentId)\n      }\n      await client.createOrReplace(linkedDocument)\n    },\n    [client, onLinkDocument, referenced, publishedExists, toast, schemaType?.liveEdit],\n  )\n\n  useEffect(() => {\n    if (documents.length > 0 && newReferenceId) {\n      // new reference is now part of the documents, we need to remove it from the newReferenceId state\n      const isAdded = documents.find(\n        (document) => getPublishedId(document._id) === getPublishedId(newReferenceId),\n      )\n      if (isAdded) setNewReferenceId(null)\n    }\n  }, [documents, newReferenceId])\n\n  const renderItem = useCallback<CommandListRenderItemCallback<SanityDocument>>(\n    (document) => (\n      <IncomingReferenceDocument\n        document={document}\n        referenceToId={referenced.id}\n        actions={actions}\n      />\n    ),\n    [referenced.id, actions],\n  )\n\n  if (!schemaType) return null\n  if (loading) {\n    return <LoadingBlock showText title={t('incoming-references-input.types-loading')} />\n  }\n  return (\n    <Stack space={2} marginBottom={2}>\n      {shouldRenderTitle && (\n        <Box paddingY={2} paddingX={0}>\n          <Text size={1} weight=\"medium\">\n            {type.title || schemaType?.title}\n          </Text>\n        </Box>\n      )}\n      <Card radius={2} padding={1} border tone=\"default\">\n        {documents.length > 0 ? (\n          <IncomingReferencesListContainer $itemCount={documents.length}>\n            <CommandList\n              activeItemDataAttr=\"data-hovered\"\n              ariaLabel={t('incoming-references-input.list-label', {\n                type: type.title || schemaType?.title,\n              })}\n              canReceiveFocus\n              fixedHeight\n              getItemKey={(index) => documents[index]._id}\n              itemHeight={INCOMING_REFERENCES_ITEM_HEIGHT}\n              items={documents}\n              onlyShowSelectionWhenActive\n              overscan={5}\n              renderItem={renderItem}\n              wrapAround={false}\n            />\n          </IncomingReferencesListContainer>\n        ) : (\n          <>\n            <Flex\n              align=\"center\"\n              justify=\"center\"\n              padding={2}\n              hidden={isAdding || Boolean(newReferenceId)}\n            >\n              <Text size={1} muted>\n                {t('incoming-references-input.no-items')}\n              </Text>\n            </Flex>\n          </>\n        )}\n\n        {newReferenceId && (\n          <SanityDefaultPreview icon={schemaType.icon} layout={'default'} isPlaceholder />\n        )}\n        {isAdding && (\n          <AddIncomingReference\n            type={type.type}\n            referenced={referenced}\n            onCreateNewReference={handleCreateNewReference}\n            onLinkDocument={handleLinkDocument}\n            creationAllowed={creationAllowed}\n            fieldName={fieldName}\n          />\n        )}\n      </Card>\n      {onLinkDocument ? (\n        <Button\n          size=\"large\"\n          disabled={false}\n          icon={AddIcon}\n          mode=\"ghost\"\n          onClick={handleAdd}\n          text={t('incoming-references-input.add-reference-item')}\n        />\n      ) : (\n        <CreateNewIncomingReference\n          type={type.type}\n          referenceToId={referenced.id}\n          referenceToType={referenced.type}\n          creationAllowed={creationAllowed}\n          onCreateNewReference={handleCreateNewReference}\n          fieldName={fieldName}\n        />\n      )}\n    </Stack>\n  )\n}\n","import {type SelectableTone} from '@sanity/ui'\nimport {\n  type ActionComponent,\n  type DocumentActionDialogProps,\n  type PreviewConfig,\n  type SanityClient,\n  type SanityDocument,\n} from 'sanity'\n\nexport type IncomingReferenceActionsContext = {\n  /**\n   * The document that is linked to the reference.\n   */\n  document: SanityDocument\n  getClient: (options: {apiVersion: string}) => SanityClient\n}\n\nexport type IncomingReferenceActionDescription = {\n  label: string\n  icon?: React.ElementType\n  tone?: SelectableTone\n  disabled?: boolean\n  onHandle: (() => Promise<void>) | (() => void)\n  dialog?: DocumentActionDialogProps | false | null\n}\n\n/**\n * Incoming reference action component definition.\n * Allows users to define actions that will be shown in the IncomingReferences component as part\n * of each reference\n * example:\n * ```ts\n * export const LogReferenceAction: IncomingReferenceAction = ({document, getClient}) => {\n *   return {\n *     label: 'Log reference',\n *     icon: LogIcon,\n *     onHandle: () => console.log(document._id)\n *   }\n * }\n * ```\n *\n * @beta\n */\nexport type IncomingReferenceAction = ActionComponent<\n  IncomingReferenceActionsContext,\n  IncomingReferenceActionDescription\n>\n\nexport interface CrossDatasetIncomingReference {\n  type: string\n  title?: string\n  dataset: string\n  preview: PreviewConfig\n  studioUrl?: (document: {id: string; type?: string}) => string | null\n}\n\nexport interface IncomingReferenceType {\n  type: string\n  dataset?: never\n  title?: string\n}\n\nexport function isIncomingReferenceType(\n  type: IncomingReferenceType | CrossDatasetIncomingReference,\n): type is IncomingReferenceType {\n  return !type.dataset\n}\n\nexport function isCrossDatasetIncomingReference(\n  type: IncomingReferenceType | CrossDatasetIncomingReference,\n): type is CrossDatasetIncomingReference {\n  return Boolean(type.dataset)\n}\n\nexport type IncomingReferencesFilterResolver = (context: {\n  document: SanityDocument | undefined\n  getClient: (options: {apiVersion: string}) => SanityClient\n}) =>\n  | string\n  | {filter: string; filterParams?: Record<string, string>}\n  | Promise<{filter: string; filterParams?: Record<string, string>}>\n\nexport type IncomingReferencesOptions = {\n  name: string\n  title?: string\n  description?: string\n  /**\n   * The type of the incoming references.\n   */\n  types: (IncomingReferenceType | CrossDatasetIncomingReference)[]\n\n  /**\n   * The filter query to apply to the incoming references in addition to the type filter.\n   * For example: filter all books that are from an specific editorial brand: `editorialBrand == \"Random House\"`\n   * The `_type` filter is applied automatically.\n   */\n  filter?: string | IncomingReferencesFilterResolver\n  filterParams?: Record<string, string>\n\n  /**\n   * Callback to link a document to a reference.\n   *\n   * This function is called when a user wants to link an existing document to the current document.\n   * It receives two parameters:\n   * - The document that will be linked (the target document)\n   * - The reference object with all properties needed to establish the link\n   *\n   * The developer must implement this function to define where and how the reference\n   * should be placed within the document structure. The function should return the\n   * modified document with the reference properly added.\n   *\n   * For example:\n   *  - We want to link a book to an author:\n   * ```ts\n   *  onLinkDocument: (document, reference) => {\n   *   return {\n   *     ...document,\n   *     author: reference,\n   *   }\n   *  }\n   * ```\n   *\n   *\n   * @param document - The document to link to the reference.\n   * @param reference - The reference to link to the document.\n   * @returns The document to link to the reference. If false, the document will not be linked to the reference.\n   */\n\n  onLinkDocument?: (\n    document: SanityDocument,\n    reference: {\n      _type: 'reference'\n      _ref: string\n      _weak?: boolean\n      _strengthenOnPublish?: {\n        type: string\n      }\n    },\n  ) => SanityDocument | false\n  /**\n   * Callback to define the actions that will be shown for the incoming reference document.\n   *\n   * For example:\n   * ```ts\n   * actions: ({document, client}) => {\n   *   return [\n   *     {label: 'Unlink document',\n   *     icon: TrashIcon,\n   *     tone: 'critical',\n   *     onClick: async () => {\n   *       await client.createOrReplace({...document, _id: getDraftId(document._id), author: undefined})\n   *     }\n   *   }\n   *  ]\n   * }\n   * ```\n   * @param context - The context of the linked document.\n   * @returns The actions that will be shown for the linked document.\n\n   */\n  actions?: IncomingReferenceAction[]\n  /**\n   * Whether to allow creation of new references.\n   * default: true\n   *\n   * If false, it will only be possible to link to existing documents, if the `onLinkDocument` callback is provided.\n   * If true, it will be possible to create new references to any template of the type.\n   * If an array is provided, it will only be possible to create new references that match the template id in the array provided.\n   *\n   * To define how a creation will be handled, you can use the `initialValue` option in the\n   * document type that will be linked.\n   *\n   * For example:\n   * I want to create a new book from an author:\n   * In the author we will have the <IncomingReferenceInput /> with the creationAllowed set to true.\n   *\n   * Then in the book type, we will have the `initialValue` option to define the default values for the new book.\n   * This initialValue callback will receive the `reference` object that needs to be linked to the book in the params.\n   *\n   * ```ts\n   * // Book type\n   * export default {\n   *   type: 'document',\n   *   name: 'book',\n   *   title: 'Book',\n   *   fields: [\n   *     {\n   *       name: 'author',\n   *       type: 'reference',\n   *       to: [{type: 'author'}],\n   *     },\n   *   ],\n   *   initialValue: (params) => {\n   *    return {\n   *      author: params?.reference,\n   *    }\n   *  }\n   * ```\n   */\n  creationAllowed?: boolean | string[]\n}\n","import {Card, Flex, Stack, Text} from '@sanity/ui'\nimport {useTranslation} from 'sanity'\n\nimport {structureLocaleNamespace} from '../../i18n'\nimport {useDocumentPane} from '../../panes/document/useDocumentPane'\nimport {CrossDatasetIncomingReferenceType} from './CrossDatasetIncomingReference/CrossDatasetIncomingReferenceType'\nimport {IncomingReferencesType} from './IncomingReferencesType'\nimport {type IncomingReferencesOptions, isCrossDatasetIncomingReference} from './types'\n\nexport function IncomingReferencesList({\n  types,\n  onLinkDocument,\n  actions,\n  filter,\n  filterParams,\n  name,\n  creationAllowed,\n}: IncomingReferencesOptions) {\n  const {documentId, documentType} = useDocumentPane()\n  const {t} = useTranslation(structureLocaleNamespace)\n\n  if (!types || types?.length === 0) {\n    return (\n      <Card border radius={2} padding={3} tone=\"critical\">\n        <Flex align=\"center\" justify=\"center\">\n          <Text size={1} muted>\n            {t('incoming-references-input.types-not-defined')}\n          </Text>\n        </Flex>\n      </Card>\n    )\n  }\n\n  return (\n    <Stack space={3}>\n      {types.map((type) => {\n        if (isCrossDatasetIncomingReference(type)) {\n          return (\n            <CrossDatasetIncomingReferenceType\n              key={`${type.type}-${type.dataset || ''}`}\n              type={type}\n              referenced={{id: documentId, type: documentType}}\n              shouldRenderTitle={types.length > 1}\n            />\n          )\n        }\n        return (\n          <IncomingReferencesType\n            key={type.type}\n            type={type}\n            referenced={{id: documentId, type: documentType}}\n            onLinkDocument={onLinkDocument}\n            actions={actions}\n            shouldRenderTitle={types.length > 1}\n            fieldName={name}\n            creationAllowed={creationAllowed}\n            filter={filter}\n            filterParams={filterParams}\n          />\n        )\n      })}\n    </Stack>\n  )\n}\n","import {Box, Flex, Stack, Text} from '@sanity/ui'\nimport {startCase} from 'lodash-es'\n\nimport {IncomingReferencesList} from './IncomingReferencesList'\nimport {type IncomingReferencesOptions} from './types'\n\n/**\n * @beta\n */\nexport function IncomingReferencesDecoration(\n  props: IncomingReferencesOptions & {\n    name: string\n    title?: string\n    description?: string\n  },\n) {\n  const {\n    onLinkDocument,\n    actions,\n    filter,\n    filterParams,\n    name,\n    creationAllowed = true,\n    types,\n    title,\n    description,\n  } = props\n\n  return (\n    <Stack space={2}>\n      <Box paddingY={2}>\n        <Stack space={3}>\n          <Flex align=\"center\" paddingY={1}>\n            <Text as=\"label\" weight=\"medium\" size={1}>\n              {title || startCase(name)}\n            </Text>\n          </Flex>\n\n          {description && (\n            <Text muted size={1}>\n              {description}\n            </Text>\n          )}\n        </Stack>\n      </Box>\n      <IncomingReferencesList\n        name={name}\n        types={types}\n        onLinkDocument={onLinkDocument}\n        actions={actions}\n        filter={filter}\n        filterParams={filterParams}\n        creationAllowed={creationAllowed}\n      />\n    </Stack>\n  )\n}\n","import {type DecorationMember} from 'sanity'\n\nimport {IncomingReferencesDecoration} from './IncomingReferencesDecoration'\nimport {type IncomingReferencesOptions} from './types'\n\n/**\n * Helper function to define an incoming references decoration.\n *\n * example:\n * ```ts\n * defineType({\n *   name: 'author',\n *   type: 'document',\n *   renderMembers: (members) => {\n *    return [\n *      ...members,\n *      defineIncomingReferenceDecoration({\n *        name: 'incomingReferences',\n *        title: 'Incoming references',\n *        types: [{type: 'author'}],\n *      }),\n *    ]\n *   },\n * })\n * ```\n *\n * @beta\n */\nexport function defineIncomingReferenceDecoration(\n  options: IncomingReferencesOptions,\n): DecorationMember {\n  return {\n    kind: 'decoration',\n    key: options.name,\n    component: <IncomingReferencesDecoration {...options} />,\n  }\n}\n","import {type DocumentDefinition} from 'sanity'\n\nexport interface IncomingReferenceCreationParams {\n  reference: {\n    _type: 'reference'\n    _ref: string\n    _weak?: boolean\n    _strengthenOnPublish?: {\n      type: string\n    }\n  }\n  from: {\n    fieldName: string\n    type: string\n  }\n  __internal_isIncomingReferenceCreation: true\n  [key: string]: unknown\n}\n\n/**\n * Helper function to check if the document is being created from an incoming reference.\n * It will be used in the initialValue callback to determine if the document is being created from an incoming reference.\n *\n * example:\n * ```ts\n * defineType({\n *   name: 'book',\n *   type: 'document',\n *   fields: [...],\n *   initialValue: (params) => {\n *     // If the document is being created from an incoming reference, return the reference\n *     // Otherwise, return undefined\n *     return {\n *       author: isIncomingReferenceCreation(params) ? params.reference : undefined,\n *     }\n *   },\n * })\n * ```\n *\n * @beta\n */\nexport function isIncomingReferenceCreation(\n  initialValue: DocumentDefinition['initialValue'],\n): initialValue is IncomingReferenceCreationParams {\n  return (\n    typeof initialValue === 'object' &&\n    initialValue !== null &&\n    '__internal_isIncomingReferenceCreation' in initialValue\n  )\n}\n"],"names":["CrossDatasetIncomingReferenceType","t0","$","_c","type","referenced","shouldRenderTitle","client","useClient","DEFAULT_STUDIO_CLIENT_OPTIONS","documentPreviewStore","useDocumentPreviewStore","t1","id","getCrossDatasetIncomingReferences","documentId","references$","documents","loading","useObservable","INITIAL_STATE","schema","useSchema","t","useTranslation","structureLocaleNamespace","T0","T1","t10","t2","t3","t4","t5","t6","t7","t8","t9","Symbol","for","bb0","schemaType","get","t11","document","renderItem","t12","t13","Stack","title","Card","length","index","INCOMING_REFERENCES_ITEM_HEIGHT","CreateNewIncomingReference","referenceToId","referenceToType","onCreateNewReference","fieldName","creationAllowed","initialValueTemplateItems","useReferenceInputOptions","navigate","useRouter","routerPanesState","groupIndex","usePaneRouter","option","uuid","panes","slice","getPublishedId","params","template","payload","reference","_type","_ref","_weak","_strengthenOnPublish","from","__internal_isIncomingReferenceCreation","handleCreate","i","typeMatch","Array","isArray","includes","filter","map","_temp","isNonNullable","createOptions","item","i18n","icon","parameters","permission","granted","reason","undefined","getPerspective","isDraftId","isVersionId","getVersionFromId","isPublishedId","LinkToExistingPreview","props","value","onLinkToDocument","data","releases","useActiveReleases","_id","getPreviewStateObservable","previewStateObservable","snapshot","isLoading","original","getReleaseTone","kind","tone","text","releaseId","r","getReleaseIdFromReleaseDocumentId","release","find","releaseTitle","metadata","releaseFallback","badgeProps","getPreviewValueWithFallback","fallback","displayTitle","INITIAL_SEARCH_STATE","hits","NO_FILTER","incomingReferenceSearch","searchStrategy","search","createSearch","maxDepth","DEFAULT_MAX_FIELD_DEPTH","strategy","tag","textTerm","perspective","pipe","hit","docs","byId","Map","forEach","doc","set","publishedId","entry","values","collated","AddIncomingReference","onLinkDocument","push","useToast","source","useSource","handleSearch","searchState","setSearchState","useState","inputValue$","switchMap","searchString","concat","of","catchError","error","description","message","status","console","scan","tap","handleQueryChange","useObservableEvent","_temp2","options","handleAutocompleteOpenButtonClick","renderOption","gridTemplateColumns","t14","onClick","t15","t16","t17","t18","prevState","nextState","IncomingReferencesType","actions","filterParams","displayed","useDocumentPane","getClient","displayedId","getIncomingReferences","isAdding","setIsAdding","newReferenceId","setNewReferenceId","editState","toast","handleAdd","publishedExists","Boolean","published","handleCreateNewReference","liveEdit","documentId_0","fetch","linkedDocument","getDraftId","createOrReplace","handleLinkDocument","document_0","useEffect","document_1","AddIcon","p","isCrossDatasetIncomingReference","dataset","IncomingReferencesList","types","name","documentType","IncomingReferencesDecoration","startCase","defineIncomingReferenceDecoration","key","component","isIncomingReferenceCreation","initialValue"],"mappings":"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"}