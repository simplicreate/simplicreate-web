{"version":3,"file":"StructureToolProvider.js","sources":["../../src/structure/i18n/index.ts","../../src/structure/structureBuilder/util/getExtendedProjection.ts","../../src/structure/structureBuilder/SerializeError.ts","../../src/structure/structureBuilder/Sort.ts","../../src/structure/structureBuilder/MenuItem.ts","../../src/structure/structureBuilder/MenuItemGroup.ts","../../src/structure/structureBuilder/util/validateId.ts","../../src/structure/structureBuilder/util/getStructureNodeId.ts","../../src/structure/structureBuilder/Component.ts","../../src/structure/structureBuilder/Divider.ts","../../src/structure/structureBuilder/util/resolveTypeForDocument.ts","../../src/structure/structureBuilder/views/View.ts","../../src/structure/structureBuilder/views/ComponentView.ts","../../src/structure/structureBuilder/views/FormView.ts","../../src/structure/structureBuilder/views/index.ts","../../src/structure/structureBuilder/Document.ts","../../src/structure/structureBuilder/InitialValueTemplateItem.ts","../../src/structure/structureBuilder/Intent.ts","../../src/structure/structureBuilder/Layout.ts","../../src/structure/structureBuilder/GenericList.ts","../../src/structure/structureBuilder/DocumentList.ts","../../src/structure/structureBuilder/List.ts","../../src/structure/structureBuilder/ListItem.ts","../../src/structure/structureBuilder/DocumentListItem.ts","../../src/structure/structureBuilder/DocumentTypeList.ts","../../src/structure/structureBuilder/documentTypeListItems.ts","../../src/structure/structureBuilder/createStructureBuilder.ts","../../src/structure/StructureToolProvider.tsx"],"sourcesContent":["import {defineLocaleResourceBundle} from 'sanity'\n\n/**\n * The locale namespace for the structure tool\n *\n * @public\n */\nexport const structureLocaleNamespace = 'structure' as const\n\n/**\n * The default locale bundle for the structure tool, which is US English.\n *\n * @internal\n */\nexport const structureUsEnglishLocaleBundle = defineLocaleResourceBundle({\n  locale: 'en-US',\n  namespace: structureLocaleNamespace,\n  resources: () => import('./resources'),\n})\n\n/**\n * The locale resource keys for the structure tool.\n *\n * @alpha\n * @hidden\n */\nexport type {StructureLocaleResourceKeys} from './resources'\n","import {type SchemaType, type SortOrderingItem} from '@sanity/types'\n\nconst IMPLICIT_SCHEMA_TYPE_FIELDS = ['_id', '_type', '_createdAt', '_updatedAt', '_rev']\n\n// Takes a path array and a schema type and builds a GROQ join every time it enters a reference field\nfunction joinReferences(schemaType: SchemaType, path: string[], strict: boolean = false): string {\n  const [head, ...tail] = path\n\n  if (!('fields' in schemaType)) {\n    return ''\n  }\n\n  const schemaField = schemaType.fields.find((field) => field.name === head)\n  if (!schemaField) {\n    if (!IMPLICIT_SCHEMA_TYPE_FIELDS.includes(head)) {\n      const errorMessage = `The current ordering config targeted the nonexistent field \"${head}\" on schema type \"${schemaType.name}\". It should be one of ${schemaType.fields.map((field) => field.name).join(', ')}`\n      if (strict) {\n        throw new Error(errorMessage)\n      } else {\n        console.warn(errorMessage)\n      }\n    }\n    return ''\n  }\n\n  if ('to' in schemaField.type && schemaField.type.name === 'reference') {\n    const refTypes = schemaField.type.to\n    return `${head}->{${refTypes.map((refType) => joinReferences(refType, tail)).join(',')}}`\n  }\n\n  const tailFields = tail.length > 0 && joinReferences(schemaField.type, tail)\n  const tailWrapper = tailFields ? `{${tailFields}}` : ''\n  return tail.length > 0 ? `${head}${tailWrapper}` : head\n}\n\nexport function getExtendedProjection(\n  schemaType: SchemaType,\n  orderBy: SortOrderingItem[],\n  strict: boolean = false,\n): string {\n  return orderBy\n    .map((ordering) => joinReferences(schemaType, ordering.field.split('.'), strict))\n    .join(', ')\n}\n","import {type SerializePath} from './StructureNodes'\n\n/** @internal */\nexport class SerializeError extends Error {\n  public readonly path: SerializePath\n  public helpId?: (typeof HELP_URL)[keyof typeof HELP_URL]\n\n  constructor(\n    message: string,\n    parentPath: SerializePath,\n    pathSegment: string | number | undefined,\n    hint?: string,\n  ) {\n    super(message)\n    this.name = 'SerializeError'\n    const segment = typeof pathSegment === 'undefined' ? '<unknown>' : `${pathSegment}`\n    this.path = (parentPath || []).concat(hint ? `${segment} (${hint})` : segment)\n  }\n\n  withHelpUrl(id: (typeof HELP_URL)[keyof typeof HELP_URL]): SerializeError {\n    this.helpId = id\n    return this\n  }\n}\n\n/** @internal */\nexport const HELP_URL = {\n  ID_REQUIRED: 'structure-node-id-required' as const,\n  TITLE_REQUIRED: 'structure-title-required' as const,\n  FILTER_REQUIRED: 'structure-filter-required' as const,\n  INVALID_LIST_ITEM: 'structure-invalid-list-item' as const,\n  COMPONENT_REQUIRED: 'structure-view-component-required' as const,\n  DOCUMENT_ID_REQUIRED: 'structure-document-id-required' as const,\n  DOCUMENT_TYPE_REQUIRED: 'structure-document-type-required' as const,\n  SCHEMA_TYPE_REQUIRED: 'structure-schema-type-required' as const,\n  SCHEMA_TYPE_NOT_FOUND: 'structure-schema-type-not-found' as const,\n  LIST_ITEMS_MUST_BE_ARRAY: 'structure-list-items-must-be-array' as const,\n  QUERY_PROVIDED_FOR_FILTER: 'structure-query-provided-for-filter' as const,\n  ACTION_OR_INTENT_REQUIRED: 'structure-action-or-intent-required' as const,\n  LIST_ITEM_IDS_MUST_BE_UNIQUE: 'structure-list-item-ids-must-be-unique' as const,\n  ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE: 'structure-action-and-intent-mutually-exclusive' as const,\n  API_VERSION_REQUIRED_FOR_CUSTOM_FILTER:\n    'structure-api-version-required-for-custom-filter' as const,\n}\n","import {type SortOrdering} from '@sanity/types'\n\nimport {structureLocaleNamespace} from '../i18n'\n\nexport const ORDER_BY_UPDATED_AT: SortOrdering = {\n  title: 'Last edited',\n  i18n: {\n    title: {\n      key: 'menu-items.sort-by.last-edited',\n      ns: structureLocaleNamespace,\n    },\n  },\n  name: 'lastEditedDesc',\n  by: [{field: '_updatedAt', direction: 'desc'}],\n}\n\nexport const ORDER_BY_CREATED_AT: SortOrdering = {\n  title: 'Created',\n  i18n: {\n    title: {\n      key: 'menu-items.sort-by.created',\n      ns: structureLocaleNamespace,\n    },\n  },\n  name: 'lastCreatedDesc',\n  by: [{field: '_createdAt', direction: 'desc'}],\n}\n\nexport const DEFAULT_SELECTED_ORDERING_OPTION = ORDER_BY_UPDATED_AT\n\nexport const DEFAULT_ORDERING_OPTIONS: SortOrdering[] = [\n  ORDER_BY_UPDATED_AT, // _updatedAt\n  ORDER_BY_CREATED_AT, // _createdAt\n]\n","import {SortIcon} from '@sanity/icons'\nimport {type SchemaType, type SortOrdering, type SortOrderingItem} from '@sanity/types'\nimport {type I18nTextRecord} from 'sanity'\n\nimport {type Intent} from './Intent'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {DEFAULT_ORDERING_OPTIONS} from './Sort'\nimport {type Serializable, type SerializeOptions, type SerializePath} from './StructureNodes'\nimport {type StructureContext} from './types'\nimport {getExtendedProjection} from './util/getExtendedProjection'\n\n/** @internal */\nexport function maybeSerializeMenuItem(\n  item: MenuItem | MenuItemBuilder,\n  index: number,\n  path: SerializePath,\n): MenuItem {\n  return item instanceof MenuItemBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * Menu item action type\n * @public */\nexport type MenuItemActionType =\n  | string\n  | ((params: Record<string, unknown> | undefined, scope?: unknown) => void)\n\n/**\n * Known menu item parameters that control built-in behavior.\n * These properties have specific meanings in the structure builder.\n *\n * @public */\nexport interface KnownMenuItemParams {\n  /**\n   * When true, hides all visual indicators showing this menu item is selected.\n   * This includes both the checkmark icon and the pressed/selected styling.\n   * The item can still be selected - this only affects the visual feedback.\n   * Useful when you want the menu item to perform an action without showing a selection state.\n   */\n  hideSelectionIndicator?: boolean\n\n  /**\n   * The value to associate with this menu item for tracking selected state.\n   * Used with the 'setMenuItemState' action for custom toggle behavior.\n   * When a menu item is clicked, this value is stored against the menu item's `id`.\n   * Defaults to `true` if not specified.\n   */\n  value?: unknown\n\n  /**\n   * Layout key for layout switching menu items.\n   * Used with the 'setLayout' action.\n   */\n  layout?: string\n\n  /**\n   * Sort ordering configuration for sort menu items.\n   * Used with the 'setSortOrder' action.\n   */\n  by?: SortOrderingItem[]\n\n  /**\n   * Extended projection string for sort ordering.\n   * Used internally for sort menu items.\n   */\n  extendedProjection?: string\n}\n\n/**\n * Menu items parameters.\n * Includes known parameters that control built-in behavior,\n * plus allows additional custom parameters.\n *\n * @public */\nexport type MenuItemParamsType = KnownMenuItemParams & Record<string, unknown>\n\n/**\n * Interface for menu items\n *\n * @public */\nexport interface MenuItem {\n  /**\n   * Unique identifier for the menu item.\n   * Used for tracking selected state of custom menu items.\n   * Menu items with the same id will share selected state (like radio buttons).\n   */\n  id?: string\n  /**\n   * The i18n key and namespace used to populate the localized title. This is\n   * the recommend way to set the title if you are localizing your studio.\n   */\n  i18n?: I18nTextRecord<'title'>\n  /**\n   * Menu Item title. Note that the `i18n` configuration will take\n   * precedence and this title is left here as a fallback if no i18n key is\n   * provided and compatibility with older plugins\n   */\n  title: string\n  /** Menu Item action */\n  action?: MenuItemActionType\n  /** Menu Item intent */\n  intent?: Intent\n  /** Menu Item group */\n  group?: string\n  // TODO: align these with TemplateItem['icon']\n  /** Menu Item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** Menu Item parameters. See {@link MenuItemParamsType} */\n  params?: MenuItemParamsType\n  /** Determine if it will show the MenuItem as action */\n  showAsAction?: boolean\n}\n\n/**\n * Partial menu items\n * @public\n */\nexport type PartialMenuItem = Partial<MenuItem>\n\n/**\n * Class for building menu items.\n *\n * @public */\nexport class MenuItemBuilder implements Serializable<MenuItem> {\n  /** menu item option object. See {@link PartialMenuItem} */\n  protected spec: PartialMenuItem\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: MenuItem,\n  ) {\n    this._context = _context\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set menu item id for tracking selected state.\n   * Menu items with the same id will share selected state (like radio buttons).\n   * Use with action 'setMenuItemState' to enable automatic selected state tracking.\n   * @param id - unique identifier for the menu item\n   * @returns menu item builder based on id provided. See {@link MenuItemBuilder}\n   */\n  id(id: string): MenuItemBuilder {\n    return this.clone({id})\n  }\n\n  /**\n   * Get menu item id\n   * @returns menu item id. See {@link PartialMenuItem}\n   */\n  getId(): PartialMenuItem['id'] {\n    return this.spec.id\n  }\n\n  /**\n   * Set menu item action\n   * @param action - menu item action. See {@link MenuItemActionType}\n   * @returns menu item builder based on action provided. See {@link MenuItemBuilder}\n   */\n  action(action: MenuItemActionType): MenuItemBuilder {\n    return this.clone({action})\n  }\n\n  /**\n   * Get menu item action\n   * @returns menu item builder action. See {@link PartialMenuItem}\n   */\n  getAction(): PartialMenuItem['action'] {\n    return this.spec.action\n  }\n\n  /**\n   * Set menu item intent\n   * @param intent - menu item intent. See {@link Intent}\n   * @returns menu item builder based on intent provided. See {@link MenuItemBuilder}\n   */\n  intent(intent: Intent): MenuItemBuilder {\n    return this.clone({intent})\n  }\n\n  /**\n   * Get menu item intent\n   * @returns menu item intent. See {@link PartialMenuItem}\n   */\n  getIntent(): PartialMenuItem['intent'] {\n    return this.spec.intent\n  }\n\n  /**\n   * Set menu item title\n   * @param title - menu item title\n   * @returns menu item builder based on title provided. See {@link MenuItemBuilder}\n   */\n  title(title: string): MenuItemBuilder {\n    return this.clone({title})\n  }\n\n  /**\n   * Get menu item title. Note that the `i18n` configuration will take\n   * precedence and this title is left here for compatibility.\n   * @returns menu item title\n   */\n  getTitle(): string | undefined {\n    return this.spec.title\n  }\n\n  /**\n   * Set the i18n key and namespace used to populate the localized title.\n   * @param i18n - object with i18n key and related namespace\n   * @returns menu item builder based on i18n config provided. See {@link MenuItemBuilder}\n   */\n  i18n(i18n: I18nTextRecord<'title'>): MenuItemBuilder {\n    return this.clone({i18n})\n  }\n\n  /**\n   * Get the i18n key and namespace used to populate the localized title.\n   * @returns the i18n key and namespace used to populate the localized title.\n   */\n  getI18n(): I18nTextRecord<'title'> | undefined {\n    return this.spec.i18n\n  }\n\n  /**\n   * Set menu item group\n   * @param group - menu item group\n   * @returns menu item builder based on group provided. See {@link MenuItemBuilder}\n   */\n  group(group: string): MenuItemBuilder {\n    return this.clone({group})\n  }\n\n  /**\n   * Get menu item group\n   * @returns menu item group. See {@link PartialMenuItem}\n   */\n  getGroup(): PartialMenuItem['group'] {\n    return this.spec.group\n  }\n\n  /**\n   * Set menu item icon\n   * @param icon - menu item icon\n   * @returns menu item builder based on icon provided. See {@link MenuItemBuilder}\n   */\n  icon(icon: React.ComponentType | React.ReactNode): MenuItemBuilder {\n    return this.clone({icon})\n  }\n\n  /**\n   * Get menu item icon\n   * @returns menu item icon. See {@link PartialMenuItem}\n   */\n  getIcon(): PartialMenuItem['icon'] {\n    return this.spec.icon\n  }\n\n  /**\n   * Set menu item parameters\n   * @param params - menu item parameters. See {@link MenuItemParamsType}\n   * @returns menu item builder based on parameters provided. See {@link MenuItemBuilder}\n   */\n  params(params: MenuItemParamsType): MenuItemBuilder {\n    return this.clone({params})\n  }\n\n  /**\n   * Get meny item parameters\n   * @returns menu item parameters. See {@link PartialMenuItem}\n   */\n  getParams(): PartialMenuItem['params'] {\n    return this.spec.params\n  }\n\n  /**\n   * Set menu item to show as action\n   * @param showAsAction - determine if menu item should show as action\n   * @returns menu item builder based on if it should show as action. See {@link MenuItemBuilder}\n   */\n  showAsAction(showAsAction = true): MenuItemBuilder {\n    return this.clone({showAsAction: Boolean(showAsAction)})\n  }\n\n  /**\n   * Check if menu item should show as action\n   * @returns true if menu item should show as action, false if not. See {@link PartialMenuItem}\n   */\n  getShowAsAction(): PartialMenuItem['showAsAction'] {\n    return this.spec.showAsAction\n  }\n\n  /** Serialize menu item builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns menu item node based on path provided in options. See {@link MenuItem}\n   */\n  serialize(options: SerializeOptions = {path: []}): MenuItem {\n    const {title, action, intent} = this.spec\n\n    if (!title) {\n      const hint = typeof action === 'string' ? `action: \"${action}\"` : undefined\n      throw new SerializeError(\n        '`title` is required for menu item',\n        options.path,\n        options.index,\n        hint,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    // Menu items with an id don't need an action - they toggle automatically\n    if (!action && !intent) {\n      throw new SerializeError(\n        `\\`action\\` or \\`intent\\` required for menu item with title ${this.spec.title}`,\n        options.path,\n        options.index,\n        `\"${title}\"`,\n      ).withHelpUrl(HELP_URL.ACTION_OR_INTENT_REQUIRED)\n    }\n\n    if (intent && action) {\n      throw new SerializeError(\n        'cannot set both `action` AND `intent`',\n        options.path,\n        options.index,\n        `\"${title}\"`,\n      ).withHelpUrl(HELP_URL.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE)\n    }\n\n    return {...this.spec, title}\n  }\n\n  /** Clone menu item builder\n   * @param withSpec - menu item options. See {@link PartialMenuItem}\n   * @returns menu item builder based on context and spec provided. See {@link MenuItemBuilder}\n   */\n  clone(withSpec?: PartialMenuItem): MenuItemBuilder {\n    const builder = new MenuItemBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n\n/** @internal */\nexport interface SortMenuItem extends MenuItem {\n  params: {\n    by: SortOrderingItem[]\n  }\n}\n\n/** @internal */\nexport function getOrderingMenuItem(\n  context: StructureContext,\n  {by, title, i18n}: SortOrdering,\n  extendedProjection?: string,\n): MenuItemBuilder {\n  let builder = new MenuItemBuilder(context)\n    .group('sorting')\n    .title(\n      context.i18n.t('default-menu-item.fallback-title', {\n        // note this lives in the `studio` bundle because that one is loaded by default\n        ns: 'studio',\n        replace: {title}, // replaces the `{{title}}` option\n      }),\n    ) // fallback title\n    .icon(SortIcon)\n    .action('setSortOrder')\n    .params({by, extendedProjection})\n\n  if (i18n) {\n    builder = builder.i18n(i18n)\n  }\n\n  return builder\n}\n\n/** @internal */\nexport function getOrderingMenuItemsForSchemaType(\n  context: StructureContext,\n  typeName: SchemaType | string,\n): MenuItemBuilder[] {\n  const {schema} = context\n  const type = typeof typeName === 'string' ? schema.get(typeName) : typeName\n  if (!type || !('orderings' in type)) {\n    return []\n  }\n\n  return (\n    type.orderings ? type.orderings.concat(DEFAULT_ORDERING_OPTIONS) : DEFAULT_ORDERING_OPTIONS\n  ).map((ordering: SortOrdering) =>\n    getOrderingMenuItem(context, ordering, getExtendedProjection(type, ordering.by)),\n  )\n}\n","import {type I18nTextRecord} from 'sanity'\n\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {type Serializable, type SerializeOptions, type SerializePath} from './StructureNodes'\nimport {type StructureContext} from './types'\n\n/** @internal */\nexport function maybeSerializeMenuItemGroup(\n  item: MenuItemGroup | MenuItemGroupBuilder,\n  index: number,\n  path: SerializePath,\n): MenuItemGroup {\n  return item instanceof MenuItemGroupBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * Interface for menu item groups\n * @public\n */\nexport interface MenuItemGroup {\n  /** Menu group Id */\n  id: string\n  /** Menu group title */\n  title: string\n  i18n?: I18nTextRecord<'title'>\n}\n\n/**\n * Class for building menu item groups.\n *\n * @public\n */\nexport class MenuItemGroupBuilder implements Serializable<MenuItemGroup> {\n  /** Menu item group ID */\n  protected _id: string\n  /** Menu item group title */\n  protected _title: string\n\n  protected _i18n?: I18nTextRecord<'title'>\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: MenuItemGroup,\n  ) {\n    this._context = _context\n    this._id = spec ? spec.id : ''\n    this._title = spec ? spec.title : ''\n    this._i18n = spec ? spec.i18n : undefined\n  }\n\n  /**\n   * Set menu item group ID\n   * @param id - menu item group ID\n   * @returns menu item group builder based on ID provided. See {@link MenuItemGroupBuilder}\n   */\n  id(id: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {id, title: this._title, i18n: this._i18n})\n  }\n\n  /**\n   * Get menu item group ID\n   * @returns menu item group ID\n   */\n  getId(): string {\n    return this._id\n  }\n\n  /**\n   * Set menu item group title\n   * @param title - menu item group title\n   * @returns menu item group builder based on title provided. See {@link MenuItemGroupBuilder}\n   */\n  title(title: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {title, id: this._id, i18n: this._i18n})\n  }\n\n  /**\n   * Get menu item group title\n   * @returns menu item group title\n   */\n  getTitle(): string {\n    return this._title\n  }\n\n  /**\n   * Set the i18n key and namespace used to populate the localized title.\n   * @param i18n - object with i18n key and related namespace\n   * @returns menu item group builder based on i18n info provided. See {@link MenuItemGroupBuilder}\n   */\n  i18n(i18n: I18nTextRecord<'title'>): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {i18n, id: this._id, title: this._title})\n  }\n\n  /**\n   * Get the i18n key and namespace used to populate the localized title.\n   * @returns the i18n key and namespace used to populate the localized title.\n   */\n  getI18n(): I18nTextRecord<'title'> | undefined {\n    return this._i18n\n  }\n\n  /**\n   * Serialize menu item group builder\n   * @param options - serialization options (path). See {@link SerializeOptions}\n   * @returns menu item group based on path provided in options. See {@link MenuItemGroup}\n   */\n  serialize(options: SerializeOptions = {path: []}): MenuItemGroup {\n    if (!this._id) {\n      throw new SerializeError(\n        '`id` is required for a menu item group',\n        options.path,\n        options.index,\n        this._title,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!this._title) {\n      throw new SerializeError(\n        '`title` is required for a menu item group',\n        options.path,\n        this._id,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: this._id,\n      title: this._title,\n      i18n: this._i18n,\n    }\n  }\n}\n","import {SerializeError} from '../SerializeError'\nimport {type SerializePath} from '../StructureNodes'\n\nexport const disallowedPattern = /([^A-Za-z0-9-_.])/\n\nexport function validateId(\n  id: string,\n  parentPath: SerializePath,\n  pathSegment: string | number | undefined,\n): string {\n  if (typeof id !== 'string') {\n    throw new SerializeError(\n      `Structure node id must be of type string, got ${typeof id}`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  const [disallowedChar] = id.match(disallowedPattern) || []\n  if (disallowedChar) {\n    throw new SerializeError(\n      `Structure node id cannot contain character \"${disallowedChar}\"`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  if (id.startsWith('__edit__')) {\n    throw new SerializeError(\n      `Structure node id cannot start with __edit__`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  return id\n}\n","import {camelCase} from 'lodash-es'\nimport getSlug from 'speakingurl'\n\nimport {disallowedPattern} from './validateId'\n\nexport function getStructureNodeId(title: string, id?: string): string {\n  if (id) {\n    return id\n  }\n\n  const camelCased = camelCase(title)\n\n  return disallowedPattern.test(camelCased) ? camelCase(getSlug(title)) : camelCased\n}\n","import {type I18nTextRecord} from 'sanity'\n\nimport {type IntentChecker} from './Intent'\nimport {maybeSerializeMenuItem, type MenuItem, type MenuItemBuilder} from './MenuItem'\nimport {\n  maybeSerializeMenuItemGroup,\n  type MenuItemGroup,\n  type MenuItemGroupBuilder,\n} from './MenuItemGroup'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {\n  type Child,\n  type Serializable,\n  type SerializeOptions,\n  type StructureNode,\n} from './StructureNodes'\nimport {type UserComponent} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\nimport {validateId} from './util/validateId'\n\n/**\n * Interface for component\n *\n * @public\n */\n// TODO: rename to `StructureComponent` since it clashes with React?\nexport interface Component extends StructureNode {\n  /** Component of type {@link UserComponent} */\n  component: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component menu items, array of type {@link MenuItem} */\n  menuItems: MenuItem[]\n  /** Component menu item group, array of type {@link MenuItemGroup} */\n  menuItemGroups: MenuItemGroup[]\n  /** Component options */\n  options: {[key: string]: unknown}\n  canHandleIntent?: IntentChecker\n}\n\n/**\n * Interface for component input\n *\n * @public\n */\nexport interface ComponentInput extends StructureNode {\n  /** Component of type {@link UserComponent} */\n  component: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component options */\n  options?: {[key: string]: unknown}\n  /** Component menu items. See {@link MenuItem} and {@link MenuItemBuilder}  */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Component menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Interface for buildable component\n *\n * @public\n */\nexport interface BuildableComponent extends Partial<StructureNode> {\n  /** Component of type {@link UserComponent} */\n  component?: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component options */\n  options?: {[key: string]: unknown}\n  /** Component menu items. See {@link MenuItem} and {@link MenuItemBuilder}  */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Component menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n  canHandleIntent?: IntentChecker\n}\n\n/**\n * Class for building components\n *\n * @public\n */\nexport class ComponentBuilder implements Serializable<Component> {\n  /** component builder option object */\n  protected spec: BuildableComponent\n\n  constructor(spec?: ComponentInput) {\n    this.spec = {options: {}, ...(spec ? spec : {})}\n  }\n\n  /** Set Component ID\n   * @param id - component ID\n   * @returns component builder based on ID provided\n   */\n  id(id: string): ComponentBuilder {\n    return this.clone({id})\n  }\n\n  /** Get ID\n   * @returns ID\n   */\n  getId(): BuildableComponent['id'] {\n    return this.spec.id\n  }\n\n  /** Set Component title\n   * @param title - component title\n   * @returns component builder based on title provided (and ID)\n   */\n  title(title: string): ComponentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get Component title\n   * @returns title\n   */\n  getTitle(): BuildableComponent['title'] {\n    return this.spec.title\n  }\n\n  /** Set the i18n key and namespace used to populate the localized title.\n   * @param i18n - the key and namespaced used to populate the localized title.\n   * @returns component builder based on i18n key and ns provided\n   */\n  i18n(i18n: I18nTextRecord<'title'>): ComponentBuilder {\n    return this.clone({i18n})\n  }\n\n  /** Get i18n key and namespace used to populate the localized title\n   * @returns the i18n key and namespace used to populate the localized title\n   */\n  getI18n(): I18nTextRecord<'title'> | undefined {\n    return this.spec.i18n\n  }\n\n  /** Set Component child\n   * @param child - child component\n   * @returns component builder based on child component provided\n   */\n  child(child: Child): ComponentBuilder {\n    return this.clone({child})\n  }\n\n  /** Get Component child\n   * @returns child component\n   */\n  getChild(): BuildableComponent['child'] {\n    return this.spec.child\n  }\n\n  /** Set component\n   * @param component - user built component\n   * @returns component builder based on component provided\n   */\n  component(component: UserComponent): ComponentBuilder {\n    return this.clone({component})\n  }\n\n  /** Get Component\n   * @returns component\n   */\n  getComponent(): BuildableComponent['component'] {\n    return this.spec.component\n  }\n\n  /** Set Component options\n   * @param options - component options\n   * @returns component builder based on options provided\n   */\n  options(options: {[key: string]: unknown}): ComponentBuilder {\n    return this.clone({options})\n  }\n\n  /** Get Component options\n   * @returns component options\n   */\n  getOptions(): NonNullable<BuildableComponent['options']> {\n    return this.spec.options || {}\n  }\n\n  /** Set Component menu items\n   * @param menuItems - component menu items\n   * @returns component builder based on menuItems provided\n   */\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[]): ComponentBuilder {\n    return this.clone({menuItems})\n  }\n\n  /** Get Component menu items\n   * @returns menu items\n   */\n  getMenuItems(): BuildableComponent['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  /** Set Component menu item groups\n   * @param menuItemGroups - component menu item groups\n   * @returns component builder based on menuItemGroups provided\n   */\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ComponentBuilder {\n    return this.clone({menuItemGroups})\n  }\n\n  /** Get Component menu item groups\n   * @returns menu item groups\n   */\n  getMenuItemGroups(): BuildableComponent['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  canHandleIntent(canHandleIntent: IntentChecker): ComponentBuilder {\n    return this.clone({canHandleIntent})\n  }\n\n  /** Serialize component\n   * @param options - serialization options\n   * @returns component object based on path provided in options\n   *\n   */\n  serialize(options: SerializeOptions = {path: []}): Component {\n    const {id, title, child, options: componentOptions, component} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for `component` structure item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!component) {\n      throw new SerializeError(\n        '`component` is required for `component` structure item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      type: 'component',\n      child,\n      component,\n      canHandleIntent: this.spec.canHandleIntent,\n      options: componentOptions || {},\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, options.path),\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, options.path),\n      ),\n    }\n  }\n\n  /** Clone component builder (allows for options overriding)\n   * @param withSpec - component builder options\n   * @returns cloned builder\n   */\n  clone(withSpec?: BuildableComponent): ComponentBuilder {\n    const builder = new ComponentBuilder()\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n","import {uniqueId} from 'lodash-es'\nimport {type I18nTextRecord} from 'sanity'\n\nimport {type Divider, type Serializable} from './StructureNodes'\n\nexport class DividerBuilder implements Serializable<Divider> {\n  protected spec: Divider\n\n  constructor(spec?: Divider) {\n    this.spec = {\n      id: uniqueId('__divider__'),\n      type: 'divider',\n      ...spec,\n    }\n  }\n\n  /** Set the title of the divider\n   * @param title - the title of the divider\n   * @returns divider builder based on title provided\n   */\n  title(title: string): DividerBuilder {\n    return this.clone({\n      title,\n    })\n  }\n\n  /** Get the title of the divider\n   * @returns the title of the divider\n   */\n  getTitle(): Divider['title'] {\n    return this.spec.title\n  }\n\n  /** Set the i18n key and namespace used to populate the localized title.\n   * @param i18n - the key and namespaced used to populate the localized title.\n   * @returns divider builder based on i18n key and ns provided\n   */\n  i18n(i18n: I18nTextRecord<'title'>): DividerBuilder {\n    return this.clone({\n      i18n,\n    })\n  }\n\n  /** Get i18n key and namespace used to populate the localized title\n   * @returns the i18n key and namespace used to populate the localized title\n   */\n  getI18n(): I18nTextRecord<'title'> | undefined {\n    return this.spec.i18n\n  }\n\n  /** Serialize the divider\n   * @returns the serialized divider\n   */\n  serialize(): Divider {\n    return {...this.spec}\n  }\n\n  /** Clone divider builder (allows for options overriding)\n   * @param withSpec - divider builder options\n   * @returns cloned builder\n   */\n  clone(withSpec?: Partial<Divider>): DividerBuilder {\n    const builder = new DividerBuilder()\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n","import {type SanityClient} from '@sanity/client'\nimport {DEFAULT_STUDIO_CLIENT_OPTIONS, getPublishedId, type SourceClientOptions} from 'sanity'\n\nexport async function resolveTypeForDocument(\n  getClient: (options: SourceClientOptions) => SanityClient,\n  id: string,\n): Promise<string | undefined> {\n  const query = '*[sanity::versionOf($publishedId)][0]._type'\n\n  const type = await getClient(DEFAULT_STUDIO_CLIENT_OPTIONS).fetch(\n    query,\n    {publishedId: getPublishedId(id)},\n    {tag: 'structure.resolve-type'},\n  )\n\n  return type\n}\n","import {kebabCase} from 'lodash-es'\n\nimport {HELP_URL, SerializeError} from '../SerializeError'\nimport {type Serializable, type SerializeOptions, type SerializePath} from '../StructureNodes'\nimport {type View} from '../types'\nimport {validateId} from '../util/validateId'\nimport {type ComponentViewBuilder} from './ComponentView'\nimport {type FormViewBuilder} from './FormView'\n\n/**\n * Interface for base view\n *\n * @public */\nexport interface BaseView {\n  /** View id */\n  id: string\n  /** View Title */\n  title: string\n  /** View Icon */\n  icon?: React.ComponentType | React.ReactNode\n}\n\n/**\n * Class for building generic views.\n *\n * @public\n */\nexport abstract class GenericViewBuilder<\n  TView extends Partial<BaseView>,\n  ConcreteImpl,\n> implements Serializable<BaseView> {\n  /** Generic view option object */\n  protected spec: TView = {} as TView\n\n  /** Set generic view ID\n   * @param id - generic view ID\n   * @returns generic view builder based on ID provided.\n   */\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n  /** Get generic view ID\n   * @returns generic view ID\n   */\n  getId(): TView['id'] {\n    return this.spec.id\n  }\n\n  /** Set generic view title\n   * @param title - generic view title\n   * @returns generic view builder based on title provided and (if provided) its ID.\n   */\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: this.spec.id || kebabCase(title)})\n  }\n\n  /** Get generic view title\n   * @returns generic view title\n   */\n  getTitle(): TView['title'] {\n    return this.spec.title\n  }\n\n  /** Set generic view icon\n   * @param icon - generic view icon\n   * @returns generic view builder based on icon provided.\n   */\n  icon(icon: React.ComponentType | React.ReactNode): ConcreteImpl {\n    return this.clone({icon})\n  }\n\n  /** Get generic view icon\n   * @returns generic view icon\n   */\n  getIcon(): TView['icon'] {\n    return this.spec.icon\n  }\n\n  /** Serialize generic view\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns generic view object based on path provided in options. See {@link BaseView}\n   */\n  serialize(options: SerializeOptions = {path: []}): BaseView {\n    const {id, title, icon} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!title) {\n      throw new SerializeError(\n        '`title` is required for view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      icon,\n    }\n  }\n\n  /** Clone generic view builder (allows for options overriding)\n   * @param withSpec - Partial generic view builder options. See {@link BaseView}\n   * @returns Generic view builder.\n   */\n  abstract clone(withSpec?: Partial<BaseView>): ConcreteImpl\n}\n\nfunction isSerializable(view: BaseView | Serializable<BaseView>): view is Serializable<BaseView> {\n  return typeof (view as Serializable<BaseView>).serialize === 'function'\n}\n\n/** @internal */\nexport function maybeSerializeView(\n  item: View | Serializable<View>,\n  index: number,\n  path: SerializePath,\n): View {\n  return isSerializable(item) ? item.serialize({path, index}) : item\n}\n\n/**\n * View builder. See {@link ComponentViewBuilder} and {@link FormViewBuilder}\n *\n * @public\n */\nexport type ViewBuilder = ComponentViewBuilder | FormViewBuilder\n","import {isRecord} from 'sanity'\n\nimport {HELP_URL, SerializeError} from '../SerializeError'\nimport {type SerializeOptions} from '../StructureNodes'\nimport {type UserViewComponent} from '../types'\nimport {type BaseView, GenericViewBuilder} from './View'\n\n/**\n * Interface for component views.\n *\n * @public */\nexport interface ComponentView<TOptions = Record<string, any>> extends BaseView {\n  type: 'component'\n  /** Component view components. See {@link UserViewComponent} */\n  component: UserViewComponent\n  /** Component view options */\n  options: TOptions\n}\n\nconst isComponentSpec = (spec: unknown): spec is ComponentView =>\n  isRecord(spec) && spec.type === 'component'\n\n/**\n * Class for building a component view.\n *\n * @public */\nexport class ComponentViewBuilder extends GenericViewBuilder<\n  Partial<ComponentView>,\n  ComponentViewBuilder\n> {\n  /** Partial Component view option object. See {@link ComponentView} */\n  protected spec: Partial<ComponentView>\n\n  constructor(\n    /**\n     * Component view component or spec\n     * @param componentOrSpec - user view component or partial component view. See {@link UserViewComponent} and {@link ComponentView}\n     */\n    componentOrSpec?: UserViewComponent | Partial<ComponentView>,\n  ) {\n    const spec = isComponentSpec(componentOrSpec) ? {...componentOrSpec} : {options: {}}\n\n    super()\n    this.spec = spec\n\n    const userComponent =\n      typeof componentOrSpec === 'function' ? componentOrSpec : this.spec.component\n\n    if (userComponent) {\n      // Because we're cloning, this'll return a new instance, so grab the spec from it\n      this.spec = this.component(userComponent).spec\n    }\n  }\n\n  /** Set view Component\n   * @param component - component view component. See {@link UserViewComponent}\n   * @returns component view builder based on component view provided. See {@link ComponentViewBuilder}\n   */\n  component(component: UserViewComponent): ComponentViewBuilder {\n    return this.clone({component})\n  }\n\n  /** Get view Component\n   * @returns Partial component view. See {@link ComponentView}\n   */\n  getComponent(): Partial<ComponentView>['component'] {\n    return this.spec.component\n  }\n\n  /** Set view Component options\n   * @param options - component view options\n   * @returns component view builder based on options provided. See {@link ComponentViewBuilder}\n   */\n  options(options: {[key: string]: any}): ComponentViewBuilder {\n    return this.clone({options})\n  }\n\n  /** Get view Component options\n   * @returns component view options. See {@link ComponentView}\n   */\n  getOptions(): ComponentView['options'] {\n    return this.spec.options || {}\n  }\n\n  /** Serialize view Component\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns component view based on path provided in options. See {@link ComponentView}\n   *\n   */\n  serialize(options: SerializeOptions = {path: []}): ComponentView {\n    const base = super.serialize(options)\n\n    const component = this.spec.component\n    if (typeof component !== 'function') {\n      throw new SerializeError(\n        '`component` is required and must be a function for `component()` view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.COMPONENT_REQUIRED)\n    }\n\n    return {\n      ...base,\n      component,\n      options: this.spec.options || {},\n      type: 'component',\n    }\n  }\n\n  /** Clone Component view builder (allows for options overriding)\n   * @param withSpec - partial for component view option. See {@link ComponentView}\n   * @returns component view builder. See {@link ComponentViewBuilder}\n   */\n  clone(withSpec?: Partial<ComponentView>): ComponentViewBuilder {\n    const builder = new ComponentViewBuilder()\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n","import {type SerializeOptions} from '../StructureNodes'\nimport {type BaseView, GenericViewBuilder} from './View'\n\n/**\n * Interface for form views.\n *\n * @public */\nexport interface FormView extends BaseView {\n  type: 'form'\n}\n\n/**\n * Class for building a form view.\n *\n * @public */\nexport class FormViewBuilder extends GenericViewBuilder<Partial<BaseView>, FormViewBuilder> {\n  /** Document list options. See {@link FormView} */\n  protected spec: Partial<FormView>\n\n  constructor(spec?: Partial<FormView>) {\n    super()\n    this.spec = {id: 'editor', title: 'Editor', ...(spec ? spec : {})}\n  }\n\n  /**\n   * Serialize Form view builder\n   * @param options - Serialize options. See {@link SerializeOptions}\n   * @returns form view builder based on path provided in options. See {@link FormView}\n   */\n  serialize(options: SerializeOptions = {path: []}): FormView {\n    return {\n      ...super.serialize(options),\n      type: 'form',\n    }\n  }\n\n  /**\n   * Clone Form view builder (allows for options overriding)\n   * @param withSpec - Partial form view builder options. See {@link FormView}\n   * @returns form view builder. See {@link FormViewBuilder}\n   */\n  clone(withSpec?: Partial<FormView>): FormViewBuilder {\n    const builder = new FormViewBuilder()\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n","import {type UserViewComponent} from '../types'\nimport {type ComponentView, ComponentViewBuilder} from './ComponentView'\nimport {type FormView, FormViewBuilder} from './FormView'\n\nexport * from './ComponentView'\nexport * from './FormView'\nexport * from './View'\n\n/** @internal */\nexport const form = (spec?: Partial<FormView>): FormViewBuilder => new FormViewBuilder(spec)\n\n/** @internal */\nexport const component = (\n  componentOrSpec?: UserViewComponent | Partial<ComponentView>,\n): ComponentViewBuilder => new ComponentViewBuilder(componentOrSpec)\n","import {type SchemaType} from '@sanity/types'\nimport {uniq} from 'lodash-es'\nimport {type I18nTextRecord} from 'sanity'\n\nimport {type ChildResolver} from './ChildResolver'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {\n  type Child,\n  type DocumentNode,\n  type EditorNode,\n  type Serializable,\n  type SerializeOptions,\n} from './StructureNodes'\nimport {type StructureContext, type View} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\nimport {validateId} from './util/validateId'\nimport {form} from './views'\nimport {maybeSerializeView, type ViewBuilder} from './views/View'\n\nconst createDocumentChildResolver =\n  ({resolveDocumentNode, getClient}: StructureContext): ChildResolver =>\n  async (itemId, {params, path}) => {\n    let type = params.type\n\n    const parentPath = path.slice(0, path.length - 1)\n    const currentSegment = path[path.length - 1]\n\n    if (!type) {\n      type = await resolveTypeForDocument(getClient, itemId)\n    }\n\n    if (!type) {\n      throw new SerializeError(\n        `Failed to resolve document, and no type provided in parameters.`,\n        parentPath,\n        currentSegment,\n      )\n    }\n\n    return resolveDocumentNode({documentId: itemId, schemaType: type})\n  }\n\n/**\n * Interface for options of Partial Documents. See {@link PartialDocumentNode}\n *\n * @public */\nexport interface DocumentOptions {\n  /** Document Id */\n  id: string\n  /** Document Type */\n  type: string\n  /** Document Template */\n  template?: string\n  /** Template parameters */\n  templateParameters?: Record<string, unknown>\n}\n\n/**\n * Interface for partial document (focused on the document pane)\n *\n * @public */\nexport interface PartialDocumentNode {\n  /** Document Id */\n  id?: string\n  /** Document title */\n  title?: string\n  /** I18n key and namespace used to populate the localized title */\n  i18n?: I18nTextRecord<'title'>\n  /** Document children of type {@link Child} */\n  child?: Child\n  /**\n   * Views for the document pane. See {@link ViewBuilder} and {@link View}\n   */\n  views?: (View | ViewBuilder)[]\n  /**\n   * Document options. See {@link DocumentOptions}\n   */\n  options?: Partial<DocumentOptions>\n  /**\n   * View IDs to open as split panes by default when the document is opened.\n   * Pass an array of view IDs that match the IDs defined in `views`.\n   * If specified with 2+ valid view IDs, the document will open in split-pane mode.\n   */\n  defaultPanes?: string[]\n}\n\n/**\n * A `DocumentBuilder` is used to build a document node.\n *\n * @public */\nexport class DocumentBuilder implements Serializable<DocumentNode> {\n  /** Component builder option object See {@link PartialDocumentNode} */\n  protected spec: PartialDocumentNode\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: PartialDocumentNode,\n  ) {\n    this._context = _context\n    this.spec = spec ? spec : {}\n  }\n\n  /** Set Document Builder ID\n   * @param id - document builder ID\n   * @returns document builder based on ID provided. See {@link DocumentBuilder}\n   */\n  id(id: string): DocumentBuilder {\n    return this.clone({id})\n  }\n\n  /** Get Document Builder ID\n   * @returns document ID. See {@link PartialDocumentNode}\n   */\n  getId(): PartialDocumentNode['id'] {\n    return this.spec.id\n  }\n\n  /** Set Document title\n   * @param title - document title\n   * @returns document builder based on title provided (and ID). See {@link DocumentBuilder}\n   */\n  title(title: string): DocumentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get Document title\n   * @returns document title. See {@link PartialDocumentNode}\n   */\n  getTitle(): PartialDocumentNode['title'] {\n    return this.spec.title\n  }\n\n  /** Set the i18n key and namespace used to populate the localized title.\n   * @param i18n - the key and namespaced used to populate the localized title.\n   * @returns component builder based on i18n key and ns provided\n   */\n  i18n(i18n: I18nTextRecord<'title'>): DocumentBuilder {\n    return this.clone({i18n})\n  }\n\n  /** Get i18n key and namespace used to populate the localized title\n   * @returns the i18n key and namespace used to populate the localized title\n   */\n  getI18n(): I18nTextRecord<'title'> | undefined {\n    return this.spec.i18n\n  }\n\n  /** Set Document child\n   * @param child - document child\n   * @returns document builder based on child provided. See {@link DocumentBuilder}\n   */\n  child(child: Child): DocumentBuilder {\n    return this.clone({child})\n  }\n\n  /** Get Document child\n   * @returns document child. See {@link PartialDocumentNode}\n   */\n  getChild(): PartialDocumentNode['child'] {\n    return this.spec.child\n  }\n\n  /** Set Document ID\n   * @param documentId - document ID\n   * @returns document builder with document based on ID provided. See {@link DocumentBuilder}\n   */\n  documentId(documentId: string): DocumentBuilder {\n    // Let's try to be a bit helpful and assign an ID from document ID if none is specified\n    const paneId = this.spec.id || documentId\n    return this.clone({\n      id: paneId,\n      options: {\n        ...this.spec.options,\n        id: documentId,\n      },\n    })\n  }\n\n  /** Get Document ID\n   * @returns document ID. See {@link DocumentOptions}\n   */\n  getDocumentId(): Partial<DocumentOptions>['id'] {\n    return this.spec.options?.id\n  }\n\n  /** Set Document Type\n   * @param documentType - document type\n   * @returns document builder with document based on type provided. See {@link DocumentBuilder}\n   */\n  schemaType(documentType: SchemaType | string): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...this.spec.options,\n        type: typeof documentType === 'string' ? documentType : documentType.name,\n      },\n    })\n  }\n\n  /** Get Document Type\n   * @returns document type. See {@link DocumentOptions}\n   */\n  getSchemaType(): Partial<DocumentOptions>['type'] {\n    return this.spec.options?.type\n  }\n\n  /** Set Document Template\n   * @param templateId - document template ID\n   * @param parameters - document template parameters\n   * @returns document builder with document based on template provided. See {@link DocumentBuilder}\n   */\n  initialValueTemplate(templateId: string, parameters?: Record<string, unknown>): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...this.spec.options,\n        template: templateId,\n        templateParameters: parameters,\n      },\n    })\n  }\n\n  /** Get Document Template\n   * @returns document template. See {@link DocumentOptions}\n   */\n  getInitialValueTemplate(): Partial<DocumentOptions>['template'] {\n    return this.spec.options?.template\n  }\n\n  /** Get Document's initial value Template parameters\n   * @returns document template parameters. See {@link DocumentOptions}\n   */\n  getInitialValueTemplateParameters(): Partial<DocumentOptions>['templateParameters'] {\n    return this.spec.options?.templateParameters\n  }\n\n  /** Set Document views\n   * @param views - document views. See {@link ViewBuilder} and {@link View}\n   * @returns document builder with document based on views provided. See {@link DocumentBuilder}\n   */\n  views(views: (View | ViewBuilder)[]): DocumentBuilder {\n    return this.clone({views})\n  }\n\n  /** Get Document views\n   * @returns document views. See {@link ViewBuilder} and {@link View}\n   */\n  getViews(): (View | ViewBuilder)[] {\n    return this.spec.views || []\n  }\n\n  /**\n   * Set the view IDs to open as split panes by default when the document is opened.\n   * Pass an array of view IDs that match the IDs defined in `views()`.\n   * If specified with 2+ valid view IDs, the document will open in split-pane mode.\n   *\n   * @param viewIds - Array of view IDs to open as split panes\n   * @returns document builder with defaultPanes config. See {@link DocumentBuilder}\n   *\n   * @example\n   * ```ts\n   * S.document()\n   *   .schemaType('article')\n   *   .views([\n   *     S.view.form().id('editor'),\n   *     S.view.component(PreviewPane).id('preview').title('Preview')\n   *   ])\n   *   .defaultPanes(['editor', 'preview'])  // Opens both as split panes\n   * ```\n   */\n  defaultPanes(viewIds: string[]): DocumentBuilder {\n    return this.clone({defaultPanes: viewIds})\n  }\n\n  /** Serialize Document builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document node based on path, index and hint provided in options. See {@link DocumentNode}\n   */\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): DocumentNode {\n    const urlId = path[index || path.length - 1]\n\n    // Try to grab document ID / editor ID from URL if not defined\n    const id = this.spec.id || (urlId && `${urlId}`) || ''\n    const options: Partial<DocumentOptions> = {\n      id,\n      type: undefined,\n      template: undefined,\n      templateParameters: undefined,\n      ...this.spec.options,\n    }\n\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for document nodes',\n        path,\n        index,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options || !options.id) {\n      throw new SerializeError(\n        'document id (`id`) is required for document nodes',\n        path,\n        id,\n        hint,\n      ).withHelpUrl(HELP_URL.DOCUMENT_ID_REQUIRED)\n    }\n\n    if (!options || !options.type) {\n      throw new SerializeError(\n        'document type (`schemaType`) is required for document nodes',\n        path,\n        id,\n        hint,\n      )\n    }\n\n    const views = (this.spec.views && this.spec.views.length > 0 ? this.spec.views : [form()]).map(\n      (item, i) => maybeSerializeView(item, i, path),\n    )\n\n    const viewIds = views.map((view) => view.id)\n    const dupes = uniq(viewIds.filter((viewId, i) => viewIds.includes(viewId, i + 1)))\n    if (dupes.length > 0) {\n      throw new SerializeError(\n        `document node has views with duplicate IDs: ${dupes.join(',  ')}`,\n        path,\n        id,\n        hint,\n      )\n    }\n\n    // Validate and filter defaultPanes - only include valid view IDs\n    let defaultPanes: string[] | undefined\n    if (this.spec.defaultPanes && this.spec.defaultPanes.length > 0) {\n      const validViewIds = this.spec.defaultPanes.filter((windowId) => viewIds.includes(windowId))\n      const invalidViewIds = this.spec.defaultPanes.filter(\n        (windowId) => !viewIds.includes(windowId),\n      )\n\n      if (invalidViewIds.length > 0) {\n        console.warn(\n          `DefaultPanes contains invalid view IDs that don't match any defined views: ${invalidViewIds.join(', ')}. Valid view IDs are: ${viewIds.join(', ')}`,\n        )\n      }\n\n      // Only set defaultPanes if we have 2+ valid view IDs (needed for split panes)\n      if (validViewIds.length >= 2) {\n        defaultPanes = validViewIds\n      }\n    }\n\n    return {\n      ...this.spec,\n      child: this.spec.child || createDocumentChildResolver(this._context),\n      id: validateId(id, path, index),\n      type: 'document',\n      options: getDocumentOptions(options),\n      views,\n      defaultPanes,\n    }\n  }\n\n  /** Clone Document builder\n   * @param withSpec - partial document node specification used to extend the cloned builder. See {@link PartialDocumentNode}\n   * @returns document builder based on context and spec provided. See {@link DocumentBuilder}\n   */\n  clone(withSpec: PartialDocumentNode = {}): DocumentBuilder {\n    const builder = new DocumentBuilder(this._context)\n    const options = {...this.spec.options, ...withSpec.options}\n    builder.spec = {...this.spec, ...withSpec, options}\n    return builder\n  }\n}\n\nfunction getDocumentOptions(spec: Partial<DocumentOptions>): DocumentOptions {\n  const opts: DocumentOptions = {\n    id: spec.id || '',\n    type: spec.type || '*',\n  }\n\n  if (spec.template) {\n    opts.template = spec.template\n  }\n\n  if (spec.templateParameters) {\n    opts.templateParameters = spec.templateParameters\n  }\n\n  return opts\n}\n\n/** @internal */\nexport function documentFromEditor(context: StructureContext, spec?: EditorNode): DocumentBuilder {\n  let doc = spec?.type\n    ? // Use user-defined document fragment as base if possible\n      context.resolveDocumentNode({schemaType: spec.type})\n    : // Fall back to plain old document builder\n      new DocumentBuilder(context)\n\n  if (!spec) return doc\n\n  const {id, type, template, templateParameters} = spec.options\n  doc = doc.id(spec.id).documentId(id)\n\n  if (type) {\n    doc = doc.schemaType(type)\n  }\n  if (template) {\n    doc = doc.initialValueTemplate(template, templateParameters)\n  }\n  if (spec.child) {\n    doc = doc.child(spec.child)\n  }\n\n  return doc\n}\n\n/** @internal */\nexport function documentFromEditorWithInitialValue(\n  {resolveDocumentNode, templates}: StructureContext,\n  templateId: string,\n  parameters?: Record<string, unknown>,\n): DocumentBuilder {\n  const template = templates.find((t) => t.id === templateId)\n\n  if (!template) {\n    throw new Error(`Template with ID \"${templateId}\" not defined`)\n  }\n\n  return resolveDocumentNode({schemaType: template.schemaType}).initialValueTemplate(\n    templateId,\n    parameters,\n  )\n}\n","import {AddIcon} from '@sanity/icons'\nimport {type InitialValueTemplateItem} from 'sanity'\n\nimport {type BaseIntentParams, type IntentParams} from './Intent'\nimport {type MenuItem, MenuItemBuilder} from './MenuItem'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {type Serializable, type SerializeOptions, type SerializePath} from './StructureNodes'\nimport {type StructureContext} from './types'\n\n/**\n * A `InitialValueTemplateItemBuilder` is used to build a document node with an initial value set.\n *\n * @public\n */\nexport class InitialValueTemplateItemBuilder implements Serializable<InitialValueTemplateItem> {\n  /** Initial Value template item option object. See {@link InitialValueTemplateItem} */\n  protected spec: Partial<InitialValueTemplateItem>\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: Partial<InitialValueTemplateItem>,\n  ) {\n    this._context = _context\n    this.spec = spec ? spec : {}\n  }\n\n  /** Set initial value template item builder ID\n   * @param id - initial value template item ID\n   * @returns initial value template item based on ID provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  id(id: string): InitialValueTemplateItemBuilder {\n    return this.clone({id})\n  }\n\n  /** Get initial value template item builder ID\n   * @returns initial value template item ID. See {@link InitialValueTemplateItem}\n   */\n  getId(): Partial<InitialValueTemplateItem>['id'] {\n    return this.spec.id\n  }\n\n  /** Set initial value template item title\n   * @param title - initial value template item title\n   * @returns initial value template item based on title provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  title(title: string): InitialValueTemplateItemBuilder {\n    return this.clone({title})\n  }\n\n  /** Get initial value template item title\n   * @returns initial value template item title. See {@link InitialValueTemplateItem}\n   */\n  getTitle(): Partial<InitialValueTemplateItem>['title'] {\n    return this.spec.title\n  }\n\n  /** Set initial value template item description\n   * @param description - initial value template item description\n   * @returns initial value template item builder based on description provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  description(description: string): InitialValueTemplateItemBuilder {\n    return this.clone({description})\n  }\n\n  /** Get initial value template item description\n   * @returns initial value template item description. See {@link InitialValueTemplateItem}\n   */\n  getDescription(): Partial<InitialValueTemplateItem>['description'] {\n    return this.spec.description\n  }\n\n  /** Set initial value template ID\n   * @param templateId - initial value template item template ID\n   * @returns initial value template item based builder on template ID provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  templateId(templateId: string): InitialValueTemplateItemBuilder {\n    // Let's try to be a bit helpful and assign an ID from template ID if none is specified\n    const paneId = this.spec.id || templateId\n    return this.clone({\n      id: paneId,\n      templateId,\n    })\n  }\n\n  /** Get initial value template item template ID\n   * @returns initial value template item ID. See {@link InitialValueTemplateItem}\n   */\n  getTemplateId(): Partial<InitialValueTemplateItem>['templateId'] {\n    return this.spec.templateId\n  }\n\n  /** Get initial value template item template parameters\n   * @param parameters - initial value template item parameters\n   * @returns initial value template item builder based on parameters provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  parameters(parameters: {[key: string]: any}): InitialValueTemplateItemBuilder {\n    return this.clone({parameters})\n  }\n\n  /** Get initial value template item template parameters\n   * @returns initial value template item parameters. See {@link InitialValueTemplateItem}\n   */\n  getParameters(): Partial<InitialValueTemplateItem>['parameters'] {\n    return this.spec.parameters\n  }\n\n  /** Serialize initial value template item\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns initial value template item object based on the path, index and hint provided in options. See {@link InitialValueTemplateItem}\n   */\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): InitialValueTemplateItem {\n    if (typeof this.spec.id !== 'string' || !this.spec.id) {\n      throw new SerializeError(\n        '`id` is required for initial value template item nodes',\n        path,\n        index,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!this.spec.templateId) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        this.spec.id,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const template = this._context.templates.find((t) => t.id === this.spec.templateId)\n\n    if (!template) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        this.spec.id,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: this.spec.id,\n      templateId: this.spec.id,\n      schemaType: template.schemaType,\n      type: 'initialValueTemplateItem',\n      description: this.spec.description || template.description,\n      title: this.spec.title || template.title,\n      subtitle: this.spec.subtitle,\n      icon: this.spec.icon || template.icon,\n      initialDocumentId: this.spec.initialDocumentId,\n      parameters: this.spec.parameters,\n    }\n  }\n\n  /** Clone generic view builder (allows for options overriding)\n   * @param withSpec - initial value template item builder options. See {@link InitialValueTemplateItemBuilder}\n   * @returns initial value template item builder based on the context and options provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  clone(withSpec: Partial<InitialValueTemplateItem> = {}): InitialValueTemplateItemBuilder {\n    const builder = new InitialValueTemplateItemBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n\n/** @internal */\nexport function defaultInitialValueTemplateItems(\n  context: StructureContext,\n): InitialValueTemplateItemBuilder[] {\n  const {schema, getStructureBuilder, templates} = context\n\n  // Sort templates by their schema type, in order or definition\n  const typeNames = schema.getTypeNames()\n  const ordered = templates\n    // Don't list templates that require parameters\n    // TODO: this should use the new-document template items instead maybe?\n    .filter((tpl) => !tpl.parameters?.length)\n    .sort((a, b) => typeNames.indexOf(a.schemaType) - typeNames.indexOf(b.schemaType))\n\n  // Create actual template items out of the templates\n  return ordered.map((tpl) => getStructureBuilder().initialValueTemplateItem(tpl.id))\n}\n\n/** @internal */\nexport function maybeSerializeInitialValueTemplateItem(\n  item: InitialValueTemplateItem | InitialValueTemplateItemBuilder,\n  index: number,\n  path: SerializePath,\n): InitialValueTemplateItem {\n  return item instanceof InitialValueTemplateItemBuilder ? item.serialize({path, index}) : item\n}\n\n/** @internal */\nexport function menuItemsFromInitialValueTemplateItems(\n  context: StructureContext,\n  templateItems: InitialValueTemplateItem[],\n): MenuItem[] {\n  const {schema, templates} = context\n  return templateItems.map((item) => {\n    const template = templates.find((t) => t.id === item.templateId)\n    const title = item.title || template?.title || 'Create'\n\n    const params: BaseIntentParams = {}\n    if (template && template.schemaType) {\n      params.type = template.schemaType\n    }\n\n    if (item.templateId) {\n      params.template = item.templateId\n    }\n\n    const intentParams: IntentParams = item.parameters ? [params, item.parameters] : params\n    const schemaType = template && schema.get(template.schemaType)\n\n    const i18n = item.i18n || template?.i18n\n\n    let builder = new MenuItemBuilder(context)\n      .title(title)\n      .icon((template && template.icon) || schemaType?.icon || AddIcon)\n      .intent({type: 'create', params: intentParams})\n\n    if (i18n) {\n      builder = builder.i18n(i18n)\n    }\n\n    return builder.serialize()\n  })\n}\n","import {type SearchParam} from 'sanity/router'\n\nimport {getTypeNamesFromFilter, type PartialDocumentList} from './DocumentList'\nimport {type StructureNode} from './StructureNodes'\n\n/**\n * Intent parameters (json)\n *\n * @public\n */\nexport type IntentJsonParams = {[key: string]: any}\n\n/**\n * Base intent parameters\n *\n * @public\n * @todo dedupe with core\n */\nexport interface BaseIntentParams {\n  /**\n   * Document schema type name to create/edit.\n   * Required for `create` intents, optional for `edit` (but encouraged, safer and faster)\n   */\n  type?: string\n\n  /**\n   * ID of the document to create/edit.\n   * Required for `edit` intents, optional for `create`.\n   */\n  id?: string\n\n  /**\n   * Name (ID) of initial value template to use for `create` intent. Optional.\n   */\n  template?: string\n\n  /**\n   * Experimental field path\n   *\n   * @beta\n   * @experimental\n   * @hidden\n   */\n  path?: string\n\n  /**\n   * Optional \"mode\" to use for edit intent.\n   * Known modes are `structure` and `presentation`.\n   */\n  mode?: string\n\n  /**\n   * Arbitrary/custom parameters are generally discouraged - try to keep them to a minimum,\n   * or use `payload` (arbitrary JSON-serializable object) instead.\n   */\n  [key: string]: string | undefined\n}\n\n/** @internal */\nexport const DEFAULT_INTENT_HANDLER = Symbol('Document type list canHandleIntent')\n\n/**\n * Intent parameters\n * See {@link structure.BaseIntentParams} and {@link structure.IntentJsonParams}\n *\n * @public\n */\nexport type IntentParams = BaseIntentParams | [BaseIntentParams, IntentJsonParams]\n\n/**\n * Interface for intents\n * @public */\n// TODO: intents should be unified somewhere\nexport interface Intent {\n  /** Intent type */\n  type: string\n  /** Intent parameters. See {@link IntentParams}\n   */\n  params?: IntentParams\n\n  searchParams?: SearchParam[]\n}\n\n/**\n * Interface for intent checker\n *\n * @public\n */\nexport interface IntentChecker {\n  (\n    /** Intent name */\n    intentName: string,\n    /** Intent checker parameter */\n    params: {[key: string]: any},\n    /** Structure context. See {@link StructureNode} */\n    context: {pane: StructureNode; index: number},\n  ): boolean\n  /** intent checker identify */\n  identity?: symbol\n}\n\n/** @internal */\nexport const defaultIntentChecker: IntentChecker = (intentName, params, {pane}): boolean => {\n  const isEdit = intentName === 'edit'\n  const isCreate = intentName === 'create'\n  const typedSpec = pane as PartialDocumentList\n  const paneFilter = typedSpec.options?.filter || ''\n  const paneParams = typedSpec.options?.params || {}\n  const typeNames = typedSpec.schemaTypeName\n    ? [typedSpec.schemaTypeName]\n    : getTypeNamesFromFilter(paneFilter, paneParams)\n\n  const initialValueTemplates = typedSpec.initialValueTemplates || []\n\n  if (isCreate && params.template) {\n    return initialValueTemplates.some((tpl) => tpl.templateId === params.template)\n  }\n\n  return (\n    (isEdit && params.id && typeNames.includes(params.type)) ||\n    (isCreate && typeNames.includes(params.type))\n  )\n}\n\ndefaultIntentChecker.identity = DEFAULT_INTENT_HANDLER\n","export const layoutOptions = ['default', 'card', 'media', 'detail', 'block']\n","import {type I18nTextRecord, type InitialValueTemplateItem, type PreviewLayoutKey} from 'sanity'\n\nimport {\n  type InitialValueTemplateItemBuilder,\n  maybeSerializeInitialValueTemplateItem,\n} from './InitialValueTemplateItem'\nimport {defaultIntentChecker, type IntentChecker} from './Intent'\nimport {layoutOptions} from './Layout'\nimport {maybeSerializeMenuItem, type MenuItem, type MenuItemBuilder} from './MenuItem'\nimport {\n  maybeSerializeMenuItemGroup,\n  type MenuItemGroup,\n  type MenuItemGroupBuilder,\n} from './MenuItemGroup'\nimport {SerializeError} from './SerializeError'\nimport {\n  type Child,\n  type Serializable,\n  type SerializeOptions,\n  type StructureNode,\n} from './StructureNodes'\nimport {getStructureNodeId} from './util/getStructureNodeId'\nimport {validateId} from './util/validateId'\n\nfunction noChildResolver() {\n  return undefined\n}\n\n/** @internal */\nexport const shallowIntentChecker: IntentChecker = (intentName, params, {pane, index}): boolean => {\n  return index <= 1 && defaultIntentChecker(intentName, params, {pane, index})\n}\n\n/**\n * Interface for list display options\n *\n * @public */\nexport interface ListDisplayOptions {\n  /** Check if list display should show icons */\n  showIcons?: boolean\n}\n\n/**\n * Interface for base generic list\n *\n * @public\n */\nexport interface BaseGenericList extends StructureNode {\n  /** List layout key. */\n  defaultLayout?: PreviewLayoutKey\n  /** Can handle intent. See {@link IntentChecker} */\n  canHandleIntent?: IntentChecker\n  /** List display options. See {@link ListDisplayOptions} */\n  displayOptions?: ListDisplayOptions\n  /** List child. See {@link Child} */\n  child: Child\n  /** List initial values array. See {@link InitialValueTemplateItem} and {@link InitialValueTemplateItemBuilder} */\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n}\n\n/**\n * Interface for generic list\n *\n * @public\n */\n// \"POJO\"/verbatim-version - end result\nexport interface GenericList extends BaseGenericList {\n  /** List type */\n  type: string\n  /** List menu items array. See {@link MenuItem} */\n  menuItems: MenuItem[]\n  /** List menu item groups array. See {@link MenuItemGroup} */\n  menuItemGroups: MenuItemGroup[]\n}\n\n/**\n * Interface for buildable generic list\n *\n * @public\n */\n// Used internally in builder classes to make everything optional\nexport interface BuildableGenericList extends Partial<BaseGenericList> {\n  /** List menu items array. See {@link MenuItem} and {@link MenuItemBuilder} */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** List menu items groups array. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Interface for generic list input\n * Allows builders and only requires things not inferrable\n *\n * @public */\n// Input version, allows builders and only requires things not inferrable\nexport interface GenericListInput extends StructureNode {\n  /** Input id */\n  id: string\n  /** Input title */\n  title: string\n  /** Input menu items groups. See {@link MenuItem} and {@link MenuItemBuilder} */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Input menu items groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n  /** Input initial value array. See {@link InitialValueTemplateItem} and {@link InitialValueTemplateItemBuilder} */\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n  /** Input default layout. */\n  defaultLayout?: PreviewLayoutKey\n  /** If input can handle intent. See {@link IntentChecker} */\n  canHandleIntent?: IntentChecker\n  /** Input child of type {@link Child} */\n  child?: Child\n}\n\n/**\n * Class for building generic lists\n *\n * @public\n */\nexport abstract class GenericListBuilder<\n  TList extends BuildableGenericList,\n  ConcreteImpl,\n> implements Serializable<GenericList> {\n  /** Check if initial value templates are set */\n  protected initialValueTemplatesSpecified = false\n  /** Generic list option object */\n  protected spec: TList = {} as TList\n\n  /** Set generic list ID\n   * @param id - generic list ID\n   * @returns generic list builder based on ID provided.\n   */\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n\n  /** Get generic list ID\n   * @returns generic list ID\n   */\n  getId(): TList['id'] {\n    return this.spec.id\n  }\n\n  /** Set generic list title\n   * @param title - generic list title\n   * @returns generic list builder based on title and ID provided.\n   */\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get generic list title\n   * @returns generic list title\n   */\n  getTitle(): TList['title'] {\n    return this.spec.title\n  }\n\n  /** Set the i18n key and namespace used to populate the localized title.\n   * @param i18n - the key and namespaced used to populate the localized title.\n   * @returns component builder based on i18n key and ns provided\n   */\n  i18n(i18n: I18nTextRecord<'title'>): ConcreteImpl {\n    return this.clone({i18n})\n  }\n\n  /** Get i18n key and namespace used to populate the localized title\n   * @returns the i18n key and namespace used to populate the localized title\n   */\n  getI18n(): TList['i18n'] {\n    return this.spec.i18n\n  }\n\n  /** Set generic list layout\n   * @param defaultLayout - generic list layout key.\n   * @returns generic list builder based on layout provided.\n   */\n  defaultLayout(defaultLayout: PreviewLayoutKey): ConcreteImpl {\n    return this.clone({defaultLayout})\n  }\n\n  /** Get generic list layout\n   * @returns generic list layout\n   */\n  getDefaultLayout(): TList['defaultLayout'] {\n    return this.spec.defaultLayout\n  }\n\n  /** Set generic list menu items\n   * @param menuItems - generic list menu items. See {@link MenuItem} and {@link MenuItemBuilder}\n   * @returns generic list builder based on menu items provided.\n   */\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[] | undefined): ConcreteImpl {\n    return this.clone({menuItems})\n  }\n\n  /** Get generic list menu items\n   * @returns generic list menu items\n   */\n  getMenuItems(): TList['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  /** Set generic list menu item groups\n   * @param menuItemGroups - generic list menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder}\n   * @returns generic list builder based on menu item groups provided.\n   */\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ConcreteImpl {\n    return this.clone({menuItemGroups})\n  }\n\n  /** Get generic list menu item groups\n   * @returns generic list menu item groups\n   */\n  getMenuItemGroups(): TList['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  /** Set generic list child\n   * @param child - generic list child. See {@link Child}\n   * @returns generic list builder based on child provided (clone).\n   */\n  child(child: Child): ConcreteImpl {\n    return this.clone({child})\n  }\n\n  /** Get generic list child\n   * @returns generic list child\n   */\n  getChild(): TList['child'] {\n    return this.spec.child\n  }\n\n  /** Set generic list can handle intent\n   * @param canHandleIntent - generic list intent checker. See {@link IntentChecker}\n   * @returns generic list builder based on can handle intent provided.\n   */\n  canHandleIntent(canHandleIntent?: IntentChecker): ConcreteImpl {\n    return this.clone({canHandleIntent})\n  }\n\n  /** Get generic list can handle intent\n   * @returns generic list can handle intent\n   */\n  getCanHandleIntent(): TList['canHandleIntent'] {\n    return this.spec.canHandleIntent\n  }\n\n  /** Set generic list display options\n   * @param enabled - allow / disallow for showing icons\n   * @returns generic list builder based on display options (showIcons) provided.\n   */\n  showIcons(enabled = true): ConcreteImpl {\n    return this.clone({\n      displayOptions: {...this.spec.displayOptions, showIcons: enabled},\n    })\n  }\n\n  /** Get generic list display options\n   * @returns generic list display options (specifically showIcons)\n   */\n  getShowIcons(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcons : undefined\n  }\n\n  /** Set generic list initial value templates\n   * @param templates - generic list initial value templates. See {@link InitialValueTemplateItemBuilder}\n   * @returns generic list builder based on templates provided.\n   */\n  initialValueTemplates(\n    templates:\n      | InitialValueTemplateItem\n      | InitialValueTemplateItemBuilder\n      | Array<InitialValueTemplateItem | InitialValueTemplateItemBuilder>,\n  ): ConcreteImpl {\n    this.initialValueTemplatesSpecified = true\n    return this.clone({initialValueTemplates: Array.isArray(templates) ? templates : [templates]})\n  }\n\n  /** Get generic list initial value templates\n   * @returns generic list initial value templates\n   */\n  getInitialValueTemplates(): TList['initialValueTemplates'] {\n    return this.spec.initialValueTemplates\n  }\n\n  /** Serialize generic list\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns generic list object based on path provided in options. See {@link GenericList}\n   */\n  serialize(options: SerializeOptions = {path: []}): GenericList {\n    const id = this.spec.id || ''\n    const path = options.path\n\n    const defaultLayout = this.spec.defaultLayout\n    if (defaultLayout && !layoutOptions.includes(defaultLayout)) {\n      throw new SerializeError(\n        `\\`layout\\` must be one of ${layoutOptions.map((item) => `\"${item}\"`).join(', ')}`,\n        path,\n        id || options.index,\n        this.spec.title,\n      )\n    }\n\n    const initialValueTemplates = (this.spec.initialValueTemplates || []).map((item, i) =>\n      maybeSerializeInitialValueTemplateItem(item, i, path),\n    )\n\n    return {\n      id: validateId(id, options.path, id || options.index),\n      title: this.spec.title,\n      i18n: this.spec.i18n,\n      type: 'genericList',\n      defaultLayout,\n      child: this.spec.child || noChildResolver,\n      canHandleIntent: this.spec.canHandleIntent || shallowIntentChecker,\n      displayOptions: this.spec.displayOptions,\n      initialValueTemplates,\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, path),\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, path),\n      ),\n    }\n  }\n\n  /** Clone generic list builder (allows for options overriding)\n   * @param _withSpec - generic list options.\n   * @returns generic list builder.\n   */\n  abstract clone(_withSpec?: object): ConcreteImpl\n}\n","import {generateHelpUrl} from '@sanity/generate-help-url'\nimport {AddIcon} from '@sanity/icons'\nimport {type SchemaType, type SortOrderingItem} from '@sanity/types'\nimport {DEFAULT_STUDIO_CLIENT_OPTIONS, type InitialValueTemplateItem} from 'sanity'\n\nimport {type ChildResolver, type ChildResolverOptions, type ItemChild} from './ChildResolver'\nimport {DocumentBuilder} from './Document'\nimport {\n  type BuildableGenericList,\n  type GenericList,\n  GenericListBuilder,\n  type GenericListInput,\n} from './GenericList'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {type Child, type SerializeOptions} from './StructureNodes'\nimport {type StructureContext} from './types'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\n\nconst validateFilter = (spec: PartialDocumentList, options: SerializeOptions) => {\n  const filter = spec.options?.filter.trim() || ''\n\n  if (['*', '{'].includes(filter[0])) {\n    throw new SerializeError(\n      `\\`filter\\` cannot start with \\`${filter[0]}\\` - looks like you are providing a query, not a filter`,\n      options.path,\n      spec.id,\n      spec.title,\n    ).withHelpUrl(HELP_URL.QUERY_PROVIDED_FOR_FILTER)\n  }\n\n  return filter\n}\n\nconst createDocumentChildResolverForItem =\n  (context: StructureContext): ChildResolver =>\n  (itemId: string, options: ChildResolverOptions): ItemChild | Promise<ItemChild> | undefined => {\n    const parentItem = options.parent as DocumentList\n    const template = options.params?.template\n      ? context.templates.find((tpl) => tpl.id === options.params.template)\n      : undefined\n    const type = template\n      ? template.schemaType\n      : parentItem.schemaTypeName || resolveTypeForDocument(context.getClient, itemId)\n\n    return Promise.resolve(type).then((schemaType) =>\n      schemaType\n        ? context.resolveDocumentNode({schemaType, documentId: itemId})\n        : new DocumentBuilder(context).id('editor').documentId(itemId).schemaType(''),\n    )\n  }\n\n/**\n * Partial document list\n *\n * @public\n */\nexport interface PartialDocumentList extends BuildableGenericList {\n  /** Document list options. See {@link DocumentListOptions} */\n  options?: DocumentListOptions\n  /** Schema type name */\n  schemaTypeName?: string\n}\n\n/**\n * Interface for document list input\n *\n * @public\n */\nexport interface DocumentListInput extends GenericListInput {\n  /** Document list options. See {@link DocumentListOptions} */\n  options: DocumentListOptions\n}\n\n/**\n * Interface for document list\n *\n * @public\n */\nexport interface DocumentList extends GenericList {\n  type: 'documentList'\n  /** Document list options. See {@link DocumentListOptions} */\n  options: DocumentListOptions\n  /** Document list child. See {@link Child} */\n  child: Child\n  /** Document schema type name */\n  schemaTypeName?: string\n}\n\n/**\n * Interface for document List options\n *\n * @public\n */\nexport interface DocumentListOptions {\n  /** Document list filter */\n  filter: string\n  /** Document list parameters */\n  params?: Record<string, unknown>\n  /** Document list API version */\n  apiVersion?: string\n  /** Document list API default ordering array. */\n  defaultOrdering?: SortOrderingItem[]\n}\n\n/**\n * Class for building document list\n *\n * @public\n */\nexport class DocumentListBuilder extends GenericListBuilder<\n  PartialDocumentList,\n  DocumentListBuilder\n> {\n  /** Document list options. See {@link PartialDocumentList} */\n  protected spec: PartialDocumentList\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: DocumentListInput,\n  ) {\n    super()\n    this._context = _context\n    this.spec = spec || {}\n    this.initialValueTemplatesSpecified = Boolean(spec?.initialValueTemplates)\n  }\n\n  /** Set API version\n   * @param apiVersion - API version\n   * @returns document list builder based on the options and API version provided. See {@link DocumentListBuilder}\n   */\n  apiVersion(apiVersion: string): DocumentListBuilder {\n    return this.clone({options: {...(this.spec.options || {filter: ''}), apiVersion}})\n  }\n\n  /** Get API version\n   * @returns API version\n   */\n  getApiVersion(): string | undefined {\n    return this.spec.options?.apiVersion\n  }\n\n  /** Set Document list filter\n   * @param filter - GROQ-filter used to determine which documents to display. Do not support joins, since they operate on individual documents, and will ignore order-clauses and projections. See {@link https://www.sanity.io/docs/realtime-updates}\n   * @returns document list builder based on the options and filter provided. See {@link DocumentListBuilder}\n   */\n  filter(filter: string): DocumentListBuilder {\n    return this.clone({options: {...this.spec.options, filter}})\n  }\n\n  /** Get Document list filter\n   * @returns filter\n   */\n  getFilter(): string | undefined {\n    return this.spec.options?.filter\n  }\n\n  /** Set Document list schema type name\n   * @param type - schema type name.\n   * @returns document list builder based on the schema type name provided. See {@link DocumentListBuilder}\n   */\n  schemaType(type: SchemaType | string): DocumentListBuilder {\n    const schemaTypeName = typeof type === 'string' ? type : type.name\n    return this.clone({schemaTypeName})\n  }\n\n  /** Get Document list schema type name\n   * @returns schema type name\n   */\n  getSchemaType(): string | undefined {\n    return this.spec.schemaTypeName\n  }\n\n  /** Set Document list options' parameters\n   * @param params - parameters\n   * @returns document list builder based on the options provided. See {@link DocumentListBuilder}\n   */\n  params(params: Record<string, unknown>): DocumentListBuilder {\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), params},\n    })\n  }\n\n  /** Get Document list options' parameters\n   * @returns options\n   */\n  getParams(): Record<string, unknown> | undefined {\n    return this.spec.options?.params\n  }\n\n  /** Set Document list default ordering\n   * @param ordering - default sort ordering array. See {@link SortOrderingItem}\n   * @returns document list builder based on ordering provided. See {@link DocumentListBuilder}\n   */\n  defaultOrdering(ordering: SortOrderingItem[]): DocumentListBuilder {\n    if (!Array.isArray(ordering)) {\n      throw new Error('`defaultOrdering` must be an array of order clauses')\n    }\n\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), defaultOrdering: ordering},\n    })\n  }\n\n  /** Get Document list default ordering\n   * @returns default ordering. See {@link SortOrderingItem}\n   */\n  getDefaultOrdering(): SortOrderingItem[] | undefined {\n    return this.spec.options?.defaultOrdering\n  }\n\n  /** Serialize Document list\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document list object based on path provided in options. See {@link DocumentList}\n   */\n  serialize(options: SerializeOptions = {path: []}): DocumentList {\n    if (typeof this.spec.id !== 'string' || !this.spec.id) {\n      throw new SerializeError(\n        '`id` is required for document lists',\n        options.path,\n        options.index,\n        this.spec.title,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!this.spec.options || !this.spec.options.filter) {\n      throw new SerializeError(\n        '`filter` is required for document lists',\n        options.path,\n        this.spec.id,\n        this.spec.title,\n      ).withHelpUrl(HELP_URL.FILTER_REQUIRED)\n    }\n\n    const hasSimpleFilter = this.spec.options?.filter === '_type == $type'\n    if (!hasSimpleFilter && this.spec.options.filter && !this.spec.options.apiVersion) {\n      console.warn(\n        `No apiVersion specified for document type list with custom filter: \\`${this.spec.options.filter}\\`. This will be required in the future. See %s for more info.`,\n        generateHelpUrl(HELP_URL.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER),\n      )\n    }\n    return {\n      ...super.serialize(options),\n      type: 'documentList',\n      schemaTypeName: this.spec.schemaTypeName,\n      child: this.spec.child || createDocumentChildResolverForItem(this._context),\n      options: {\n        ...this.spec.options,\n        // @todo: make specifying .apiVersion required when using custom (non-simple) filters in v4\n        apiVersion: this.spec.options.apiVersion || DEFAULT_STUDIO_CLIENT_OPTIONS.apiVersion,\n        filter: validateFilter(this.spec, options),\n      },\n    }\n  }\n\n  /** Clone Document list builder (allows for options overriding)\n   * @param withSpec - override document list spec. See {@link PartialDocumentList}\n   * @returns document list builder. See {@link DocumentListBuilder}\n   */\n  clone(withSpec?: PartialDocumentList): DocumentListBuilder {\n    const builder = new DocumentListBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n\n    if (!this.initialValueTemplatesSpecified) {\n      builder.spec.initialValueTemplates = inferInitialValueTemplates(this._context, builder.spec)\n    }\n\n    if (!builder.spec.schemaTypeName) {\n      builder.spec.schemaTypeName = inferTypeName(builder.spec)\n    }\n\n    return builder\n  }\n\n  /** Get Document list spec\n   * @returns document list spec. See {@link PartialDocumentList}\n   */\n  getSpec(): PartialDocumentList {\n    return this.spec\n  }\n}\n\nfunction inferInitialValueTemplates(\n  context: StructureContext,\n  spec: PartialDocumentList,\n): InitialValueTemplateItem[] | undefined {\n  const {document} = context\n  const {schemaTypeName, options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = schemaTypeName\n    ? [schemaTypeName]\n    : Array.from(new Set(getTypeNamesFromFilter(filter, params)))\n\n  if (typeNames.length === 0) {\n    return undefined\n  }\n\n  return typeNames\n    .flatMap((schemaType) =>\n      document.resolveNewDocumentOptions({\n        type: 'structure',\n        schemaType,\n      }),\n    )\n    .map((option) => ({...option, icon: AddIcon}))\n}\n\nfunction inferTypeName(spec: PartialDocumentList): string | undefined {\n  const {options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = getTypeNamesFromFilter(filter, params)\n  return typeNames.length === 1 ? typeNames[0] : undefined\n}\n\n/** @internal */\nexport function getTypeNamesFromFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  let typeNames = getTypeNamesFromEqualityFilter(filter, params)\n\n  if (typeNames.length === 0) {\n    typeNames = getTypeNamesFromInTypesFilter(filter, params)\n  }\n\n  return typeNames\n}\n\n// From _type == \"movie\" || _type == $otherType\nfunction getTypeNamesFromEqualityFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  const pattern =\n    /\\b_type\\s*==\\s*(['\"].*?['\"]|\\$.*?(?:\\s|$))|\\B(['\"].*?['\"]|\\$.*?(?:\\s|$))\\s*==\\s*_type/g\n  const matches: string[] = []\n  let match\n  while ((match = pattern.exec(filter)) !== null) {\n    matches.push(match[1] || match[2])\n  }\n\n  return matches\n    .map((candidate) => {\n      const typeName = candidate[0] === '$' ? params[candidate.slice(1)] : candidate\n      const normalized = ((typeName as string) || '').trim().replace(/^[\"']|[\"']$/g, '')\n      return normalized\n    })\n    .filter(Boolean)\n}\n\n// From _type in [\"dog\", \"cat\", $otherSpecies]\nfunction getTypeNamesFromInTypesFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  const pattern = /\\b_type\\s+in\\s+\\[(.*?)\\]/\n  const matches = filter.match(pattern)\n  if (!matches) {\n    return []\n  }\n\n  return matches[1]\n    .split(/,\\s*/)\n    .map((match) => match.trim().replace(/^[\"']+|[\"']+$/g, ''))\n    .map((item) => (item[0] === '$' ? params[item.slice(1)] : item))\n    .filter(Boolean) as string[]\n}\n","import {find} from 'lodash-es'\nimport {isRecord} from 'sanity'\n\nimport {type ChildResolver, type ChildResolverOptions} from './ChildResolver'\nimport {DividerBuilder} from './Divider'\nimport {isDocumentListItem} from './DocumentListItem'\nimport {\n  type BuildableGenericList,\n  type GenericList,\n  GenericListBuilder,\n  type GenericListInput,\n  shallowIntentChecker,\n} from './GenericList'\nimport {type IntentChecker} from './Intent'\nimport {type ListItem, ListItemBuilder} from './ListItem'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {type Divider, type SerializeOptions, type SerializePath} from './StructureNodes'\nimport {type StructureContext} from './types'\n\nconst getArgType = (thing: ListItem) => {\n  if (thing instanceof ListBuilder) {\n    return 'ListBuilder'\n  }\n\n  if (isPromise<ListItem>(thing)) {\n    return 'Promise'\n  }\n\n  return Array.isArray(thing) ? 'array' : typeof thing\n}\n\nconst isListItem = (item: ListItem | Divider): item is ListItem => {\n  return item.type === 'listItem'\n}\n\nconst defaultCanHandleIntent: IntentChecker = (intentName: string, params, context) => {\n  const pane = context.pane as List\n  const items = pane.items || []\n  return (\n    items\n      .filter(isDocumentListItem)\n      .some((item) => item.schemaType.name === params.type && item._id === params.id) ||\n    shallowIntentChecker(intentName, params, context)\n  )\n}\n\nconst resolveChildForItem: ChildResolver = (itemId: string, options: ChildResolverOptions) => {\n  const parentItem = options.parent as List\n  const items = parentItem.items.filter(isListItem)\n  const target = (items.find((item) => item.id === itemId) || {child: undefined}).child\n\n  if (!target || typeof target !== 'function') {\n    return target\n  }\n\n  return typeof target === 'function' ? target(itemId, options) : target\n}\n\nfunction maybeSerializeListItem(\n  item: ListItem | ListItemBuilder | Divider | DividerBuilder,\n  index: number,\n  path: SerializePath,\n): ListItem | Divider {\n  if (item instanceof ListItemBuilder) {\n    return item.serialize({path, index})\n  }\n\n  if (item instanceof DividerBuilder) {\n    return item.serialize()\n  }\n\n  const listItem = item as ListItem\n  if (listItem && listItem.type === 'divider') {\n    return item as Divider\n  }\n\n  if (!listItem || listItem.type !== 'listItem') {\n    const gotWhat = (listItem && listItem.type) || getArgType(listItem)\n    const helpText = gotWhat === 'array' ? ' - did you forget to spread (...moreItems)?' : ''\n    throw new SerializeError(\n      `List items must be of type \"listItem\", got \"${gotWhat}\"${helpText}`,\n      path,\n      index,\n    ).withHelpUrl(HELP_URL.INVALID_LIST_ITEM)\n  }\n\n  return item\n}\n\nfunction isPromise<T>(thing: unknown): thing is PromiseLike<T> {\n  return isRecord(thing) && typeof thing.then === 'function'\n}\n\n/**\n * Interface for List\n *\n * @public\n */\nexport interface List extends GenericList {\n  type: 'list'\n  /** List items. See {@link ListItem} and {@link Divider} */\n  items: (ListItem | Divider)[]\n}\n\n/**\n * Interface for list input\n *\n * @public\n */\nexport interface ListInput extends GenericListInput {\n  /** List input items array. See {@link ListItem}, {@link ListItemBuilder} and {@link Divider} */\n  items?: (ListItem | ListItemBuilder | Divider | DividerBuilder)[]\n}\n\n/**\n * Interface for buildable list\n *\n * @public\n */\nexport interface BuildableList extends BuildableGenericList {\n  /** List items. See {@link ListItem}, {@link ListItemBuilder} and {@link Divider} */\n  items?: (ListItem | ListItemBuilder | Divider | DividerBuilder)[]\n}\n\n/**\n * A `ListBuilder` is used to build a list of items in the structure tool.\n *\n * @public */\nexport class ListBuilder extends GenericListBuilder<BuildableList, ListBuilder> {\n  /** buildable list option object. See {@link BuildableList} */\n  protected spec: BuildableList\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: ListInput,\n  ) {\n    super()\n    this._context = _context\n    this.spec = spec ? spec : {}\n    this.initialValueTemplatesSpecified = Boolean(spec && spec.initialValueTemplates)\n  }\n\n  /**\n   * Set list builder based on items provided\n   * @param items - list items. See {@link ListItemBuilder}, {@link ListItem} and {@link Divider}\n   * @returns list builder based on items provided. See {@link ListBuilder}\n   */\n  items(items: (ListItemBuilder | ListItem | Divider | DividerBuilder)[]): ListBuilder {\n    return this.clone({items})\n  }\n\n  /** Get list builder items\n   * @returns list items. See {@link BuildableList}\n   */\n  getItems(): BuildableList['items'] {\n    return this.spec.items\n  }\n\n  /** Serialize list builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns list based on path in options. See {@link List}\n   */\n  serialize(options: SerializeOptions = {path: []}): List {\n    const id = this.spec.id\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for lists',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const items = typeof this.spec.items === 'undefined' ? [] : this.spec.items\n    if (!Array.isArray(items)) {\n      throw new SerializeError(\n        '`items` must be an array of items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.LIST_ITEMS_MUST_BE_ARRAY)\n    }\n\n    const path = (options.path || []).concat(id)\n    const serializedItems = items.map((item, index) => maybeSerializeListItem(item, index, path))\n    const dupes = serializedItems.filter((val, i) => find(serializedItems, {id: val.id}, i + 1))\n\n    if (dupes.length > 0) {\n      const dupeIds = dupes.map((item) => item.id).slice(0, 5)\n      const dupeDesc = dupes.length > 5 ? `${dupeIds.join(', ')}...` : dupeIds.join(', ')\n      throw new SerializeError(\n        `List items with same ID found (${dupeDesc})`,\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.LIST_ITEM_IDS_MUST_BE_UNIQUE)\n    }\n\n    return {\n      ...super.serialize(options),\n      type: 'list',\n      canHandleIntent: this.spec.canHandleIntent || defaultCanHandleIntent,\n      child: this.spec.child || resolveChildForItem,\n      items: serializedItems,\n    }\n  }\n\n  /**\n   * Clone list builder and return new list builder based on context and spec provided\n   * @param withSpec - list options. See {@link BuildableList}\n   * @returns new list builder based on context and spec provided. See {@link ListBuilder}\n   */\n  clone(withSpec?: BuildableList): ListBuilder {\n    const builder = new ListBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n","import {type SchemaType} from '@sanity/types'\nimport {type Observable} from 'rxjs'\nimport {type I18nTextRecord} from 'sanity'\n\nimport {type ChildResolver, type ItemChild} from './ChildResolver'\nimport {ComponentBuilder} from './Component'\nimport {DocumentBuilder} from './Document'\nimport {DocumentListBuilder} from './DocumentList'\nimport {ListBuilder} from './List'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {\n  type Collection,\n  type CollectionBuilder,\n  type Serializable,\n  type SerializeOptions,\n} from './StructureNodes'\nimport {type StructureContext} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\nimport {validateId} from './util/validateId'\n\n/**\n * Unserialized list item child.\n * See {@link Collection}, {@link CollectionBuilder}, {@link ChildResolver} and {@link ItemChild}\n *\n * @public\n */\nexport type UnserializedListItemChild =\n  | Collection\n  | CollectionBuilder\n  | ChildResolver\n  | Observable<ItemChild>\n\n/**\n * Child of List Item\n * See {@link Collection}, {@link ChildResolver}, {@link ItemChild}\n * @public\n */\nexport type ListItemChild = Collection | ChildResolver | Observable<ItemChild> | undefined\n\n/**\n * Interface for serialize list item options\n *\n * @public\n */\nexport interface ListItemSerializeOptions extends SerializeOptions {\n  /** Check if list item title is optional */\n  titleIsOptional?: boolean\n}\n\n/**\n * Interface for ist item display options\n *\n * @public */\nexport interface ListItemDisplayOptions {\n  /** Check if list item display should show icon */\n  showIcon?: boolean\n}\n\n/**\n * interface for list item input\n *\n * @public */\nexport interface ListItemInput {\n  /** List item id */\n  id: string\n  /** List item title */\n  title?: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link ListItemChild} */\n  child?: ListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema type. See {@link SchemaType} */\n  schemaType?: SchemaType | string\n}\n\n/**\n * Interface for List Item\n *\n * @public */\nexport interface ListItem {\n  /** List item id */\n  id: string\n  /** List item type */\n  type: string\n  /**\n   * The i18n key and namespace used to populate the localized title. This is\n   * the recommend way to set the title if you are localizing your studio.\n   */\n  i18n?: I18nTextRecord<'title'>\n  /** List item title. Note that the `i18n` key and namespace will take precedence. */\n  title?: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link ListItemChild} */\n  child?: ListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema type. See {@link SchemaType} */\n  schemaType?: SchemaType\n}\n\n/**\n * Interface for unserialized list items.\n *\n * @public\n */\nexport interface UnserializedListItem {\n  /** List item ID */\n  id: string\n  /** List item title */\n  title: string\n  /**\n   * The i18n key and namespace used to populate the localized title. This is\n   * the recommend way to set the title if you are localizing your studio.\n   */\n  i18n?: I18nTextRecord<'title'>\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link UnserializedListItemChild} */\n  child?: UnserializedListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema. See {@link SchemaType} */\n  schemaType?: SchemaType | string\n}\n\n/**\n * Partial list item. See {@link UnserializedListItem}\n *\n * @public */\nexport type PartialListItem = Partial<UnserializedListItem>\n\n/**\n * Class for building list items\n *\n * @public */\nexport class ListItemBuilder implements Serializable<ListItem> {\n  /** List item option object. See {@link PartialListItem} */\n  protected spec: PartialListItem\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: ListItemInput,\n  ) {\n    this._context = _context\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set list item ID\n   * @returns list item builder based on ID provided. See {@link ListItemBuilder}\n   */\n  id(id: string): ListItemBuilder {\n    return this.clone({id})\n  }\n\n  /**\n   * Get list item ID\n   * @returns list item ID. See {@link PartialListItem}\n   */\n  getId(): PartialListItem['id'] {\n    return this.spec.id\n  }\n\n  /**\n   * Set list item title\n   * @returns list item builder based on title provided. See {@link ListItemBuilder}\n   */\n  title(title: string): ListItemBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /**\n   * Get list item title\n   * @returns list item title. See {@link PartialListItem}\n   */\n  getTitle(): PartialListItem['title'] {\n    return this.spec.title\n  }\n\n  /** Set the i18n key and namespace used to populate the localized title.\n   * @param i18n - the key and namespaced used to populate the localized title.\n   * @returns component builder based on i18n key and ns provided\n   */\n  i18n(i18n: I18nTextRecord<'title'>): ListItemBuilder {\n    return this.clone({i18n})\n  }\n\n  /** Get i18n key and namespace used to populate the localized title\n   * @returns the i18n key and namespace used to populate the localized title\n   */\n  getI18n(): I18nTextRecord<'title'> | undefined {\n    return this.spec.i18n\n  }\n\n  /**\n   * Set list item icon\n   * @returns list item builder based on icon provided. See {@link ListItemBuilder}\n   */\n  icon(icon: React.ComponentType | React.ReactNode): ListItemBuilder {\n    return this.clone({icon})\n  }\n\n  /**\n   * Set if list item should show icon\n   * @returns list item builder based on showIcon provided. See {@link ListItemBuilder}\n   */\n  showIcon(enabled = true): ListItemBuilder {\n    return this.clone({\n      displayOptions: {...this.spec.displayOptions, showIcon: enabled},\n    })\n  }\n\n  /**\n   * Check if list item should show icon\n   * @returns true if it should show the icon, false if not, undefined if not set\n   */\n  getShowIcon(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcon : undefined\n  }\n\n  /**\n   *Get list item icon\n   * @returns list item icon. See {@link PartialListItem}\n   */\n  getIcon(): PartialListItem['icon'] {\n    return this.spec.icon\n  }\n\n  /**\n   * Set list item child\n   * @param child - list item child. See {@link UnserializedListItemChild}\n   * @returns list item builder based on child provided. See {@link ListItemBuilder}\n   */\n  child(child: UnserializedListItemChild): ListItemBuilder {\n    return this.clone({child})\n  }\n\n  /**\n   * Get list item child\n   * @returns list item child. See {@link PartialListItem}\n   */\n  getChild(): PartialListItem['child'] {\n    return this.spec.child\n  }\n\n  /**\n   * Set list item schema type\n   * @param schemaType - list item schema type. See {@link SchemaType}\n   * @returns list item builder based on schema type provided. See {@link ListItemBuilder}\n   */\n  schemaType(schemaType: SchemaType | string): ListItemBuilder {\n    return this.clone({schemaType})\n  }\n\n  /**\n   * Get list item schema type\n   * @returns list item schema type. See {@link PartialListItem}\n   */\n  getSchemaType(): PartialListItem['schemaType'] {\n    const schemaType = this.spec.schemaType\n\n    if (typeof schemaType === 'string') {\n      return this._context.schema.get(schemaType)\n    }\n\n    return this.spec.schemaType\n  }\n\n  /** Serialize list item builder\n   * @param options - serialization options. See {@link ListItemSerializeOptions}\n   * @returns list item node based on path provided in options. See {@link ListItem}\n   */\n  serialize(options: ListItemSerializeOptions = {path: []}): ListItem {\n    const {id, title, child} = this.spec\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for list items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options.titleIsOptional && (typeof title !== 'string' || !title)) {\n      throw new SerializeError('`title` is required for list items', options.path, id).withHelpUrl(\n        HELP_URL.TITLE_REQUIRED,\n      )\n    }\n\n    let schemaType = this.spec.schemaType\n    if (typeof schemaType === 'string') {\n      const type = this._context.schema.get(schemaType)\n      if (!type) {\n        throw new SerializeError(\n          `Could not find type \"${schemaType}\" in schema`,\n          options.path,\n          id,\n        ).withHelpUrl(HELP_URL.SCHEMA_TYPE_NOT_FOUND)\n      }\n\n      schemaType = type\n    }\n\n    const serializeOptions = {path: options.path.concat(id), hint: 'child'}\n    let listChild =\n      child instanceof ComponentBuilder ||\n      child instanceof DocumentListBuilder ||\n      child instanceof DocumentBuilder ||\n      child instanceof ListBuilder\n        ? child.serialize(serializeOptions)\n        : child\n\n    // In the case of a function, create a bound version that will pass the correct serialize\n    // context, so we may lazily resolve it at some point in the future without losing context\n    if (typeof listChild === 'function') {\n      const originalChild = listChild\n      listChild = (itemId, childOptions) => {\n        return originalChild(itemId, {...childOptions, serializeOptions})\n      }\n    }\n\n    return {\n      ...this.spec,\n      id: validateId(id, options.path, options.index),\n      schemaType,\n      child: listChild,\n      title,\n      type: 'listItem',\n    }\n  }\n\n  /** Clone list item builder\n   * @param withSpec - partial list item options. See {@link PartialListItem}\n   * @returns list item builder based on context and spec provided. See {@link ListItemBuilder}\n   */\n  clone(withSpec?: PartialListItem): ListItemBuilder {\n    const builder = new ListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n","import {type SchemaType} from '@sanity/types'\nimport {isRecord} from 'sanity'\n\nimport {DocumentBuilder} from './Document'\nimport {\n  type ListItem,\n  ListItemBuilder,\n  type ListItemInput,\n  type UnserializedListItem,\n} from './ListItem'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {type SerializeOptions} from './StructureNodes'\nimport {type StructureContext} from './types'\n\n/**\n * Interface for document list item input\n *\n * @public\n */\nexport interface DocumentListItemInput extends ListItemInput {\n  /** Document list item input schema type. See {@link SchemaType} */\n  schemaType: SchemaType | string\n}\n\n/**\n * Interface for document list item\n *\n * @public\n */\nexport interface DocumentListItem extends ListItem {\n  /** Document schema type. See {@link SchemaType} */\n  schemaType: SchemaType\n  /** Document ID */\n  _id: string\n}\n\n/**\n * Partial document list item\n *\n * @public\n */\nexport type PartialDocumentListItem = Partial<UnserializedListItem>\n\nconst createDefaultChildResolver =\n  (context: StructureContext, spec: PartialDocumentListItem) => (documentId: string) => {\n    const schemaType =\n      spec.schemaType &&\n      (typeof spec.schemaType === 'string' ? spec.schemaType : spec.schemaType.name)\n\n    return schemaType\n      ? context.resolveDocumentNode({schemaType, documentId})\n      : new DocumentBuilder(context).id('documentEditor').documentId(documentId)\n  }\n\n/**\n * Class for building a document list item\n *\n * @public\n */\nexport class DocumentListItemBuilder extends ListItemBuilder {\n  /** Document list options. See {@link PartialDocumentListItem} */\n  protected spec: PartialDocumentListItem\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: DocumentListItemInput,\n  ) {\n    super(_context, spec)\n    this._context = _context\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Serialize document list item\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document list item object based on path provided in options. See {@link DocumentListItem}\n   */\n  serialize(options: SerializeOptions = {path: []}): DocumentListItem {\n    const spec = super.serialize({...options, titleIsOptional: true})\n\n    if (!spec.schemaType) {\n      throw new SerializeError(\n        '`schemaType` is required for document list items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.SCHEMA_TYPE_REQUIRED)\n    }\n\n    const child = spec.child || createDefaultChildResolver(this._context, spec)\n    return {...spec, child, schemaType: spec.schemaType, _id: spec.id}\n  }\n\n  /** Clone Document list item builder (allows for options overriding)\n   * @param withSpec - Document list item builder options. See {@link PartialDocumentListItem}\n   * @returns document list item builder. See {@link DocumentListItemBuilder}\n   */\n  clone(withSpec?: PartialDocumentListItem): DocumentListItemBuilder {\n    const builder = new DocumentListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n\n/** @internal */\nexport function isDocumentListItem(item: unknown): item is DocumentListItem {\n  return isRecord(item) && typeof item.schemaType !== 'undefined' && typeof item._id === 'string'\n}\n","import {type SchemaType} from '@sanity/types'\n\nimport {DocumentListBuilder, type DocumentListInput, type PartialDocumentList} from './DocumentList'\nimport {type GenericListInput} from './GenericList'\nimport {DEFAULT_INTENT_HANDLER} from './Intent'\nimport {type Child} from './StructureNodes'\nimport {type StructureContext} from './types'\n\n/**\n * Interface for document type list input\n *\n * @public\n */\nexport interface DocumentTypeListInput extends Partial<GenericListInput> {\n  /** Document type list input schema type. See {@link SchemaType} */\n  schemaType: SchemaType | string\n}\n\n/**\n * Class for building a document type list\n *\n * @public\n */\nexport class DocumentTypeListBuilder extends DocumentListBuilder {\n  /** Document list options. See {@link PartialDocumentList} */\n  protected spec: PartialDocumentList\n\n  protected _context: StructureContext\n\n  constructor(\n    /**\n     * Structure context. See {@link StructureContext}\n     */\n    _context: StructureContext,\n    spec?: DocumentListInput,\n  ) {\n    super(_context)\n    this._context = _context\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set Document type list child\n   * @param child - Child component. See {@link Child}\n   * @returns document type list builder based on child component provided without default intent handler. See {@link DocumentTypeListBuilder}\n   */\n  child(child: Child): DocumentTypeListBuilder {\n    return this.cloneWithoutDefaultIntentHandler({child})\n  }\n\n  /** Clone Document type list builder (allows for options overriding)\n   * @param withSpec - Document type list builder options. See {@link PartialDocumentList}\n   * @returns document type list builder. See {@link DocumentTypeListBuilder}\n   */\n  clone(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    builder.spec = {...this.spec, ...parent.getSpec(), ...withSpec}\n    return builder\n  }\n\n  /** Clone Document type list builder (allows for options overriding) and remove default intent handler\n   * @param withSpec - Document type list builder options. See {@link PartialDocumentList}\n   * @returns document type list builder without default intent handler. See {@link DocumentTypeListBuilder}\n   */\n  cloneWithoutDefaultIntentHandler(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    const canHandleIntent = this.spec.canHandleIntent\n    const shouldOverride = canHandleIntent && canHandleIntent.identity === DEFAULT_INTENT_HANDLER\n    const override = shouldOverride ? {canHandleIntent: undefined} : {}\n    builder.spec = {\n      ...parent.getSpec(),\n      ...this.spec,\n      ...withSpec,\n      ...override,\n    }\n    return builder\n  }\n}\n","import {StackCompactIcon, StackIcon} from '@sanity/icons'\nimport {type SchemaType} from '@sanity/types'\nimport {startCase} from 'lodash-es'\n\nimport {structureLocaleNamespace} from '../i18n'\nimport {type DocumentListBuilder} from './DocumentList'\nimport {DocumentTypeListBuilder, type DocumentTypeListInput} from './DocumentTypeList'\nimport {defaultIntentChecker} from './Intent'\nimport {type List} from './List'\nimport {type ListItem, ListItemBuilder} from './ListItem'\nimport {getOrderingMenuItemsForSchemaType, MenuItemBuilder} from './MenuItem'\nimport {DEFAULT_SELECTED_ORDERING_OPTION} from './Sort'\nimport {type Collection} from './StructureNodes'\nimport {type StructureContext} from './types'\n\nconst BUNDLED_DOC_TYPES = ['sanity.imageAsset', 'sanity.fileAsset']\n\nfunction isBundledDocType(typeName: string) {\n  return BUNDLED_DOC_TYPES.includes(typeName)\n}\n\nfunction isDocumentType(schemaType: SchemaType) {\n  return schemaType.type?.name === 'document'\n}\n\nfunction isList(collection: Collection): collection is List {\n  return collection.type === 'list'\n}\n\nexport function getDocumentTypes({schema}: StructureContext): string[] {\n  return schema\n    .getTypeNames()\n    .filter((n) => {\n      const schemaType = schema.get(n)\n      return schemaType && isDocumentType(schemaType)\n    })\n    .filter((n) => !isBundledDocType(n))\n}\n\nexport function getDocumentTypeListItems(context: StructureContext): ListItemBuilder[] {\n  const types = getDocumentTypes(context)\n  return types.map((typeName) => getDocumentTypeListItem(context, typeName))\n}\n\nexport function getDocumentTypeListItem(\n  context: StructureContext,\n  typeName: string,\n): ListItemBuilder {\n  const {schema} = context\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n\n  return new ListItemBuilder(context)\n    .id(typeName)\n    .title(title)\n    .schemaType(type)\n    .child((id, childContext) => {\n      const parent = childContext.parent as Collection\n      const parentItem = isList(parent)\n        ? (parent.items.find((item) => item.id === id) as ListItem)\n        : null\n\n      let list = getDocumentTypeList(context, typeName)\n      if (parentItem && parentItem.title) {\n        list = list.title(parentItem.title)\n      }\n\n      return list\n    })\n}\n\nexport function getDocumentTypeList(\n  context: StructureContext,\n  typeNameOrSpec: string | DocumentTypeListInput,\n): DocumentListBuilder {\n  const {schema, resolveDocumentNode} = context\n\n  const schemaType = typeof typeNameOrSpec === 'string' ? typeNameOrSpec : typeNameOrSpec.schemaType\n  const typeName = typeof schemaType === 'string' ? schemaType : schemaType.name\n  const spec: DocumentTypeListInput =\n    typeof typeNameOrSpec === 'string' ? {schemaType} : typeNameOrSpec\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n\n  return new DocumentTypeListBuilder(context)\n    .id(spec.id || typeName)\n    .title(spec.title || title)\n    .filter('_type == $type')\n    .params({type: typeName})\n    .schemaType(type)\n    .defaultOrdering(DEFAULT_SELECTED_ORDERING_OPTION.by)\n    .menuItemGroups(\n      spec.menuItemGroups || [\n        {\n          id: 'sorting',\n          title: 'Sort',\n          i18n: {title: {key: 'menu-item-groups.actions-group', ns: structureLocaleNamespace}},\n        },\n        {\n          id: 'layout',\n          title: 'Layout',\n          i18n: {title: {key: 'menu-item-groups.layout-group', ns: structureLocaleNamespace}},\n        },\n        {\n          id: 'actions',\n          title: 'Actions',\n          i18n: {title: {key: 'menu-item-groups.sorting-group', ns: structureLocaleNamespace}},\n        },\n      ],\n    )\n    .child(\n      spec.child ||\n        ((documentId: string) => resolveDocumentNode({schemaType: typeName, documentId})),\n    )\n    .canHandleIntent(spec.canHandleIntent || defaultIntentChecker)\n    .menuItems(\n      spec.menuItems || [\n        // Create new (from action button) will be added in serialization step of GenericList\n\n        // Sort by <Y>\n        ...getOrderingMenuItemsForSchemaType(context, type),\n\n        // Display as <Z>\n        new MenuItemBuilder(context)\n          .group('layout')\n          .i18n({title: {key: 'menu-items.layout.compact-view', ns: structureLocaleNamespace}})\n          .title('Compact view') // fallback title\n          .icon(StackCompactIcon)\n          .action('setLayout')\n          .params({layout: 'default'}),\n\n        new MenuItemBuilder(context)\n          .group('layout')\n          .i18n({title: {key: 'menu-items.layout.detailed-view', ns: structureLocaleNamespace}})\n          .title('Detailed view') // fallback title\n          .icon(StackIcon)\n          .action('setLayout')\n          .params({layout: 'detail'}),\n\n        // Create new (from menu) will be added in serialization step of GenericList\n      ],\n    )\n}\n","import {type SchemaType} from '@sanity/types'\nimport {isValidElementType} from 'react-is'\nimport {\n  getConfigContextFromSource,\n  getPublishedId,\n  type PerspectiveStack,\n  type Source,\n} from 'sanity'\n\nimport {structureLocaleNamespace} from '../i18n'\nimport {ComponentBuilder, type ComponentInput} from './Component'\nimport {DividerBuilder} from './Divider'\nimport {DocumentBuilder, documentFromEditor, documentFromEditorWithInitialValue} from './Document'\nimport {DocumentListBuilder} from './DocumentList'\nimport {DocumentListItemBuilder} from './DocumentListItem'\nimport {\n  getDocumentTypeList,\n  getDocumentTypeListItem,\n  getDocumentTypeListItems,\n} from './documentTypeListItems'\nimport {\n  defaultInitialValueTemplateItems,\n  InitialValueTemplateItemBuilder,\n  menuItemsFromInitialValueTemplateItems,\n} from './InitialValueTemplateItem'\nimport {ListBuilder} from './List'\nimport {ListItemBuilder} from './ListItem'\nimport {getOrderingMenuItem, getOrderingMenuItemsForSchemaType, MenuItemBuilder} from './MenuItem'\nimport {MenuItemGroupBuilder} from './MenuItemGroup'\nimport {type Divider} from './StructureNodes'\nimport {\n  type DefaultDocumentNodeResolver,\n  type StructureBuilder,\n  type StructureContext,\n  type UserComponent,\n} from './types'\nimport * as views from './views'\n\n/** @internal */\nexport interface StructureBuilderOptions {\n  source: Source\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n  perspectiveStack: PerspectiveStack\n}\n\nfunction hasIcon(schemaType?: SchemaType | string): boolean {\n  if (!schemaType || typeof schemaType === 'string') {\n    return false\n  }\n\n  return Boolean(schemaType.icon)\n}\n\nfunction getDefaultStructure(context: StructureContext): ListBuilder {\n  const items = getDocumentTypeListItems(context)\n  return new ListBuilder(context)\n    .id('__root__')\n    .title('Content')\n    .i18n({title: {key: 'default-definition.content-title', ns: structureLocaleNamespace}})\n    .items(items)\n    .showIcons(items.some((item) => hasIcon(item.getSchemaType())))\n}\n\n/** @internal */\nexport function createStructureBuilder({\n  defaultDocumentNode,\n  source,\n  perspectiveStack,\n}: StructureBuilderOptions): StructureBuilder {\n  const configContext = getConfigContextFromSource(source)\n  const context: StructureContext = {\n    ...source,\n    getStructureBuilder: () => structureBuilder,\n    resolveDocumentNode: (options) => {\n      let builder =\n        defaultDocumentNode?.(structureBuilder, {...options, ...configContext}) ||\n        new DocumentBuilder(context)\n\n      if (!builder.getId()) {\n        builder = builder.id('documentEditor')\n      }\n\n      if (options.documentId) {\n        builder = builder.documentId(getPublishedId(options.documentId))\n      }\n\n      return builder.schemaType(options.schemaType)\n    },\n    perspectiveStack,\n  }\n\n  const structureBuilder: StructureBuilder = {\n    defaults: () => getDefaultStructure(context),\n    documentTypeList: (...args) => getDocumentTypeList(context, ...args),\n    documentTypeListItem: (...args) => getDocumentTypeListItem(context, ...args),\n    documentTypeListItems: (...args) => getDocumentTypeListItems(context, ...args),\n    document: (...args) => new DocumentBuilder(context, ...args),\n    documentWithInitialValueTemplate: (...args) =>\n      documentFromEditorWithInitialValue(context, ...args),\n    defaultDocument: context.resolveDocumentNode,\n\n    list: (...args) => new ListBuilder(context, ...args),\n    listItem: (...args) => new ListItemBuilder(context, ...args),\n\n    menuItem: (...args) => new MenuItemBuilder(context, ...args),\n    menuItemGroup: (...args) => new MenuItemGroupBuilder(context, ...args),\n    menuItemsFromInitialValueTemplateItems: (...args) =>\n      menuItemsFromInitialValueTemplateItems(context, ...args),\n\n    documentList: (...args) => new DocumentListBuilder(context, ...args),\n    documentListItem: (...args) => new DocumentListItemBuilder(context, ...args),\n\n    orderingMenuItem: (...args) => getOrderingMenuItem(context, ...args),\n    orderingMenuItemsForType: (...args) => getOrderingMenuItemsForSchemaType(context, ...args),\n\n    editor: (...args) => documentFromEditor(context, ...args),\n\n    defaultInitialValueTemplateItems: (...args) =>\n      defaultInitialValueTemplateItems(context, ...args),\n\n    initialValueTemplateItem: (\n      templateId: string,\n      parameters?: Record<string, unknown>,\n    ): InitialValueTemplateItemBuilder =>\n      new InitialValueTemplateItemBuilder(context, {\n        id: templateId,\n        parameters,\n        templateId,\n      }),\n\n    component: (spec?: ComponentInput | UserComponent) => {\n      return isValidElementType(spec)\n        ? new ComponentBuilder().component(spec as UserComponent)\n        : new ComponentBuilder(spec as ComponentInput)\n    },\n\n    divider: (spec?: Divider) => new DividerBuilder(spec),\n\n    view: views,\n    context,\n  }\n\n  return structureBuilder\n}\n","import {type ReactNode, useMemo, useState} from 'react'\nimport {useConfigContextFromSource, useDocumentStore, usePerspective, useSource} from 'sanity'\nimport {StructureToolContext} from 'sanity/_singletons'\n\nimport {createStructureBuilder, type DefaultDocumentNodeResolver} from './structureBuilder'\nimport {\n  type StructureResolver,\n  type StructureToolContextValue,\n  type UnresolvedPaneNode,\n} from './types'\n\n/** @internal */\nexport interface StructureToolProviderProps {\n  structure?: StructureResolver\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n  children: ReactNode\n}\n\n/** @internal */\nexport function StructureToolProvider({\n  defaultDocumentNode,\n  structure: resolveStructure,\n  children,\n}: StructureToolProviderProps): React.JSX.Element {\n  const [layoutCollapsed, setLayoutCollapsed] = useState(false)\n  const source = useSource()\n  const configContext = useConfigContextFromSource(source)\n  const documentStore = useDocumentStore()\n\n  const {perspectiveStack} = usePerspective()\n\n  const S = useMemo(() => {\n    return createStructureBuilder({\n      defaultDocumentNode,\n      source,\n      perspectiveStack,\n    })\n  }, [defaultDocumentNode, source, perspectiveStack])\n\n  const rootPaneNode = useMemo(() => {\n    // TODO: unify types and remove cast\n    if (resolveStructure)\n      return resolveStructure(S, {\n        ...configContext,\n        documentStore,\n\n        perspectiveStack,\n      }) as UnresolvedPaneNode\n    return S.defaults() as UnresolvedPaneNode\n  }, [resolveStructure, S, configContext, documentStore, perspectiveStack])\n\n  const features: StructureToolContextValue['features'] = useMemo(\n    () => ({\n      backButton: layoutCollapsed,\n      resizablePanes: !layoutCollapsed,\n      reviewChanges: !layoutCollapsed,\n      splitPanes: !layoutCollapsed,\n      splitViews: !layoutCollapsed,\n    }),\n    [layoutCollapsed],\n  )\n\n  const structureTool: StructureToolContextValue = useMemo(() => {\n    return {\n      features,\n      layoutCollapsed,\n      setLayoutCollapsed,\n      rootPaneNode,\n      structureContext: S.context,\n    }\n  }, [features, layoutCollapsed, rootPaneNode, S.context])\n\n  return (\n    <StructureToolContext.Provider value={structureTool}>{children}</StructureToolContext.Provider>\n  )\n}\n"],"names":["structureLocaleNamespace","structureUsEnglishLocaleBundle","defineLocaleResourceBundle","locale","namespace","resources","IMPLICIT_SCHEMA_TYPE_FIELDS","joinReferences","schemaType","path","strict","head","tail","schemaField","fields","find","field","name","includes","errorMessage","map","join","Error","console","warn","type","refTypes","to","refType","tailFields","length","tailWrapper","getExtendedProjection","orderBy","ordering","split","SerializeError","constructor","message","parentPath","pathSegment","hint","segment","concat","withHelpUrl","id","helpId","HELP_URL","ID_REQUIRED","TITLE_REQUIRED","FILTER_REQUIRED","INVALID_LIST_ITEM","COMPONENT_REQUIRED","DOCUMENT_ID_REQUIRED","DOCUMENT_TYPE_REQUIRED","SCHEMA_TYPE_REQUIRED","SCHEMA_TYPE_NOT_FOUND","LIST_ITEMS_MUST_BE_ARRAY","QUERY_PROVIDED_FOR_FILTER","ACTION_OR_INTENT_REQUIRED","LIST_ITEM_IDS_MUST_BE_UNIQUE","ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE","API_VERSION_REQUIRED_FOR_CUSTOM_FILTER","ORDER_BY_UPDATED_AT","title","i18n","key","ns","by","direction","ORDER_BY_CREATED_AT","DEFAULT_SELECTED_ORDERING_OPTION","DEFAULT_ORDERING_OPTIONS","maybeSerializeMenuItem","item","index","MenuItemBuilder","serialize","_context","spec","clone","getId","action","getAction","intent","getIntent","getTitle","getI18n","group","getGroup","icon","getIcon","params","getParams","showAsAction","Boolean","getShowAsAction","options","undefined","withSpec","builder","getOrderingMenuItem","context","extendedProjection","t","replace","SortIcon","getOrderingMenuItemsForSchemaType","typeName","schema","get","orderings","maybeSerializeMenuItemGroup","MenuItemGroupBuilder","_id","_title","_i18n","disallowedPattern","validateId","disallowedChar","match","startsWith","getStructureNodeId","camelCased","camelCase","test","getSlug","ComponentBuilder","child","getChild","component","getComponent","getOptions","menuItems","getMenuItems","menuItemGroups","getMenuItemGroups","canHandleIntent","componentOptions","i","DividerBuilder","uniqueId","resolveTypeForDocument","getClient","DEFAULT_STUDIO_CLIENT_OPTIONS","fetch","publishedId","getPublishedId","tag","GenericViewBuilder","kebabCase","isSerializable","view","maybeSerializeView","isComponentSpec","isRecord","ComponentViewBuilder","componentOrSpec","userComponent","base","FormViewBuilder","form","createDocumentChildResolver","resolveDocumentNode","itemId","slice","currentSegment","documentId","DocumentBuilder","paneId","getDocumentId","documentType","getSchemaType","initialValueTemplate","templateId","parameters","template","templateParameters","getInitialValueTemplate","getInitialValueTemplateParameters","views","getViews","defaultPanes","viewIds","urlId","dupes","uniq","filter","viewId","validViewIds","windowId","invalidViewIds","getDocumentOptions","opts","documentFromEditor","doc","documentFromEditorWithInitialValue","templates","InitialValueTemplateItemBuilder","description","getDescription","getTemplateId","getParameters","subtitle","initialDocumentId","defaultInitialValueTemplateItems","getStructureBuilder","typeNames","getTypeNames","tpl","sort","a","b","indexOf","initialValueTemplateItem","maybeSerializeInitialValueTemplateItem","menuItemsFromInitialValueTemplateItems","templateItems","intentParams","AddIcon","DEFAULT_INTENT_HANDLER","Symbol","defaultIntentChecker","intentName","pane","isEdit","isCreate","typedSpec","paneFilter","paneParams","schemaTypeName","getTypeNamesFromFilter","initialValueTemplates","some","identity","layoutOptions","noChildResolver","shallowIntentChecker","GenericListBuilder","initialValueTemplatesSpecified","defaultLayout","getDefaultLayout","getCanHandleIntent","showIcons","enabled","displayOptions","getShowIcons","Array","isArray","getInitialValueTemplates","validateFilter","trim","createDocumentChildResolverForItem","parentItem","parent","Promise","resolve","then","DocumentListBuilder","apiVersion","getApiVersion","getFilter","defaultOrdering","getDefaultOrdering","generateHelpUrl","inferInitialValueTemplates","inferTypeName","getSpec","document","from","Set","flatMap","resolveNewDocumentOptions","option","getTypeNamesFromEqualityFilter","getTypeNamesFromInTypesFilter","pattern","matches","exec","push","candidate","getArgType","thing","ListBuilder","isPromise","isListItem","defaultCanHandleIntent","items","isDocumentListItem","resolveChildForItem","target","maybeSerializeListItem","ListItemBuilder","listItem","gotWhat","helpText","getItems","serializedItems","val","dupeIds","dupeDesc","showIcon","getShowIcon","titleIsOptional","serializeOptions","listChild","originalChild","childOptions","createDefaultChildResolver","DocumentListItemBuilder","DocumentTypeListBuilder","cloneWithoutDefaultIntentHandler","override","BUNDLED_DOC_TYPES","isBundledDocType","isDocumentType","isList","collection","getDocumentTypes","n","getDocumentTypeListItems","getDocumentTypeListItem","startCase","childContext","list","getDocumentTypeList","typeNameOrSpec","StackCompactIcon","layout","StackIcon","hasIcon","getDefaultStructure","createStructureBuilder","defaultDocumentNode","source","perspectiveStack","configContext","getConfigContextFromSource","structureBuilder","defaults","documentTypeList","args","documentTypeListItem","documentTypeListItems","documentWithInitialValueTemplate","defaultDocument","menuItem","menuItemGroup","documentList","documentListItem","orderingMenuItem","orderingMenuItemsForType","editor","isValidElementType","divider","StructureToolProvider","t0","$","_c","structure","resolveStructure","children","layoutCollapsed","setLayoutCollapsed","useState","useSource","useConfigContextFromSource","documentStore","useDocumentStore","usePerspective","t1","S","t2","bb0","t3","rootPaneNode","t4","t5","t6","t7","backButton","resizablePanes","reviewChanges","splitPanes","splitViews","features","t8","structureContext","structureTool","t9"],"mappings":"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"}